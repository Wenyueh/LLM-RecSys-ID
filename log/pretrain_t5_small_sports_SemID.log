04/02/2023, 01:10:39: Namespace(seed=2022, data_dir='data/', logging_dir='log/sports/pretrain_t5_small_sports_content_based.log', model_dir='model/sports/pretrain_t5_small_sports_content_based.pt', task='sports', max_history=20, sequential_num=10, negative_sample=2, yes_no_sample=5, direct_item_proportion=2, train_sequential_item_batch=64, train_sequential_yesno_batch=32, train_direct_yesno_batch=48, train_direct_candidate_batch=12, train_direct_straightforward_batch=48, meta_title_batch=128, meta_description_batch=12, meta_category_batch=128, meta_epochs=10, meta_lr=0.0001, review_user_batch=16, review_item_batch=16, review_epochs=2, review_lr=0.0001, model_type='t5-small', epochs=20, lr=0.001, clip=1.0, logging_step=1000, warmup_prop=0.05, gradient_accumulation_steps=1, weight_decay=0.01, adam_eps=1e-06, dropout=0.1, alpha=2, multiGPU=True, distributed=True, gpu='0,2', local_rank=0, evaluation_method='sequential_item', evaluation_template_id=0, number_of_items=18358, item_representation='content_based', cluster_number=55, cluster_size=100, optimal_width_in_CF=False, category_no_repetition=False, last_token_no_repetition=False, hybrid_order='CF_first', data_order='random', remapped_data_order='original', resolution=2, max_random_number=30000, min_random_number=1000, overlap=0, base=10, random_initialization_embedding=False, whole_word_embedding='shijie', no_pretrain=False, use_meta_data=False, use_review_data=False, remove_last_item=False, remove_first_item=False, eval_only=False, check_data=False)
04/02/2023, 01:10:57: Process Launching at GPU 1
04/02/2023, 01:10:57: Process Launching at GPU 0
04/02/2023, 01:10:57: Building train loader at GPU 0
04/02/2023, 01:10:57: Building train loader at GPU 1
04/02/2023, 01:10:57: loading data ...
04/02/2023, 01:10:58: *** use content_based representation, extend vocab ***
04/02/2023, 01:12:03: finished loading data
04/02/2023, 01:12:03: length of training data is 14809
04/02/2023, 01:12:03: loading model ...
04/02/2023, 01:12:03: using only sequential data, and all possible sequences are here
04/02/2023, 01:12:03: use pretrained T5
04/02/2023, 01:12:09: Batch per epoch: 14809
04/02/2023, 01:12:09: Total steps: 296180
04/02/2023, 01:12:09: Warmup proportion:
04/02/2023, 01:12:09: Warm up steps: 14809
04/02/2023, 01:12:10: model dataparallel set
04/02/2023, 01:12:10: start training
04/02/2023, 01:12:10: ---------- training epoch 0 ----------
04/02/2023, 01:15:29: total loss for 1000 steps : 5360.173689126968
04/02/2023, 01:18:46: total loss for 2000 steps : 3592.8538711071014
04/02/2023, 01:22:07: total loss for 3000 steps : 2797.2685403823853
04/02/2023, 01:25:27: total loss for 4000 steps : 2209.5035816431046
04/02/2023, 01:28:47: total loss for 5000 steps : 1904.1661504507065
04/02/2023, 01:32:07: total loss for 6000 steps : 1722.4127966165543
04/02/2023, 01:35:28: total loss for 7000 steps : 1614.6422729492188
04/02/2023, 01:38:48: total loss for 8000 steps : 1532.9390033483505
04/02/2023, 01:42:09: total loss for 9000 steps : 1475.4599514007568
04/02/2023, 01:45:29: total loss for 10000 steps : 1427.898367524147
04/02/2023, 01:48:52: total loss for 11000 steps : 1398.382402062416
04/02/2023, 01:52:11: total loss for 12000 steps : 1374.7527561187744
04/02/2023, 01:55:32: total loss for 13000 steps : 1345.827008008957
04/02/2023, 01:58:52: total loss for 14000 steps : 1325.1688410043716
04/02/2023, 02:01:39: ---------- start evaluation after epoch 0 ----------
04/02/2023, 02:12:42: validation hit @ 1 is 0.0007303781111298388
04/02/2023, 02:12:42: validation hit @ 5 is 0.008483622675431204
04/02/2023, 02:12:42: validation hit @ 10 is 0.016967245350862407
04/02/2023, 02:12:42: validation ncdg @ 5 is 0.0043637180848088205
04/02/2023, 02:12:42: validation ncdg @ 10 is 0.007071416804908083
04/02/2023, 02:12:54: validation hit @ 1 is 0.00022473172650148884
04/02/2023, 02:12:54: validation hit @ 5 is 0.006180122478790943
04/02/2023, 02:12:54: validation hit @ 10 is 0.015618854991853474
04/02/2023, 02:12:54: validation ncdg @ 5 is 0.002943813752826792
04/02/2023, 02:12:54: validation ncdg @ 10 is 0.005959780333064118
04/02/2023, 02:23:49: test hit @ 1 is 0.0007303781111298388
04/02/2023, 02:23:49: test hit @ 5 is 0.0064610371369178046
04/02/2023, 02:23:49: test hit @ 10 is 0.013596269453340075
04/02/2023, 02:23:49: test ncdg @ 5 is 0.0033812912245566053
04/02/2023, 02:23:49: test ncdg @ 10 is 0.005673400344395458
04/02/2023, 02:23:49: recall increases from 0 ----> 0.016967245350862407 at epoch 0
04/02/2023, 02:24:16: test hit @ 1 is 0.00022473172650148884
04/02/2023, 02:24:16: test hit @ 5 is 0.00533737850441036
04/02/2023, 02:24:16: test hit @ 10 is 0.011966964436204281
04/02/2023, 02:24:16: test ncdg @ 5 is 0.002648754108922801
04/02/2023, 02:24:16: test ncdg @ 10 is 0.0047752103751490605
04/02/2023, 02:24:16: recall increases from 0 ----> 0.015618854991853474 at epoch 0
04/02/2023, 02:24:16: save current best model to best_model/sports/pretrain_t5_small_sports_content_based.pt
04/02/2023, 02:24:17: ---------- training epoch 1 ----------
04/02/2023, 02:24:56: total loss for 15000 steps : 1311.9514833688736
04/02/2023, 02:28:16: total loss for 16000 steps : 1295.2273483276367
04/02/2023, 02:31:37: total loss for 17000 steps : 1284.3742201328278
04/02/2023, 02:34:58: total loss for 18000 steps : 1270.1631639003754
04/02/2023, 02:38:20: total loss for 19000 steps : 1259.4223783016205
04/02/2023, 02:41:39: total loss for 20000 steps : 1249.993908882141
04/02/2023, 02:44:59: total loss for 21000 steps : 1241.2137145996094
04/02/2023, 02:48:18: total loss for 22000 steps : 1230.177931547165
04/02/2023, 02:51:38: total loss for 23000 steps : 1226.9850008487701
04/02/2023, 02:54:59: total loss for 24000 steps : 1217.9918352365494
04/02/2023, 02:58:19: total loss for 25000 steps : 1213.4569962024689
04/02/2023, 03:01:40: total loss for 26000 steps : 1210.2327003479004
04/02/2023, 03:05:03: total loss for 27000 steps : 1205.6652170419693
04/02/2023, 03:08:24: total loss for 28000 steps : 1198.2747597694397
04/02/2023, 03:11:44: total loss for 29000 steps : 1196.2789338827133
04/02/2023, 03:14:05: ---------- start evaluation after epoch 1 ----------
04/02/2023, 03:25:09: validation hit @ 1 is 0.0028091465812686107
04/02/2023, 03:25:09: validation hit @ 5 is 0.01471992808584752
04/02/2023, 03:25:09: validation hit @ 10 is 0.029496039103320413
04/02/2023, 03:25:09: validation ncdg @ 5 is 0.008528979320226907
04/02/2023, 03:25:09: validation ncdg @ 10 is 0.01330234982596569
04/02/2023, 03:25:24: validation hit @ 1 is 0.001573122085510422
04/02/2023, 03:25:24: validation hit @ 5 is 0.010730939940446093
04/02/2023, 03:25:24: validation hit @ 10 is 0.023484465419405586
04/02/2023, 03:25:24: validation ncdg @ 5 is 0.005979423403032094
04/02/2023, 03:25:24: validation ncdg @ 10 is 0.010099895897398663
04/02/2023, 03:36:14: test hit @ 1 is 0.0023035001966402605
04/02/2023, 03:36:14: test hit @ 5 is 0.012191696162705769
04/02/2023, 03:36:14: test hit @ 10 is 0.023428282487780214
04/02/2023, 03:36:14: test ncdg @ 5 is 0.007044800869544143
04/02/2023, 03:36:14: test ncdg @ 10 is 0.010645889816094094
04/02/2023, 03:36:14: recall increases from 0.016967245350862407 ----> 0.029496039103320413 at epoch 1
04/02/2023, 03:36:43: test hit @ 1 is 0.001067475700882072
04/02/2023, 03:36:43: test hit @ 5 is 0.010225293555817742
04/02/2023, 03:36:43: test hit @ 10 is 0.01955166020562953
04/02/2023, 03:36:43: test ncdg @ 5 is 0.005383740102682095
04/02/2023, 03:36:43: test ncdg @ 10 is 0.008375139700952617
04/02/2023, 03:36:43: recall increases from 0.015618854991853474 ----> 0.023484465419405586 at epoch 1
04/02/2023, 03:36:43: save current best model to best_model/sports/pretrain_t5_small_sports_content_based.pt
04/02/2023, 03:36:44: ---------- training epoch 2 ----------
04/02/2023, 03:38:00: total loss for 30000 steps : 1192.4734505414963
04/02/2023, 03:41:23: total loss for 31000 steps : 1186.2282609939575
04/02/2023, 03:44:39: total loss for 32000 steps : 1182.0854179859161
04/02/2023, 03:47:56: total loss for 33000 steps : 1182.49978017807
04/02/2023, 03:51:13: total loss for 34000 steps : 1176.1111814975739
04/02/2023, 03:54:28: total loss for 35000 steps : 1171.2010781764984
04/02/2023, 03:57:44: total loss for 36000 steps : 1169.2295042276382
04/02/2023, 04:00:59: total loss for 37000 steps : 1167.0513384342194
04/02/2023, 04:04:15: total loss for 38000 steps : 1163.734346151352
04/02/2023, 04:07:31: total loss for 39000 steps : 1160.958503484726
04/02/2023, 04:10:49: total loss for 40000 steps : 1160.1211429834366
04/02/2023, 04:14:08: total loss for 41000 steps : 1157.4657366275787
04/02/2023, 04:17:24: total loss for 42000 steps : 1153.109259724617
04/02/2023, 04:20:41: total loss for 43000 steps : 1150.366984128952
04/02/2023, 04:23:58: total loss for 44000 steps : 1146.3626227378845
04/02/2023, 04:25:58: ---------- start evaluation after epoch 2 ----------
04/02/2023, 04:36:50: validation hit @ 1 is 0.0057306590257879654
04/02/2023, 04:36:50: validation hit @ 5 is 0.021686611607393675
04/02/2023, 04:36:50: validation hit @ 10 is 0.03769874712062475
04/02/2023, 04:36:50: validation ncdg @ 5 is 0.013592057011521826
04/02/2023, 04:36:50: validation ncdg @ 10 is 0.01872551828555487
04/02/2023, 04:37:02: validation hit @ 1 is 0.003427158829147705
04/02/2023, 04:37:02: validation hit @ 5 is 0.016742513624360918
04/02/2023, 04:37:02: validation hit @ 10 is 0.031911905163211414
04/02/2023, 04:37:02: validation ncdg @ 5 is 0.00976081612189344
04/02/2023, 04:37:02: validation ncdg @ 10 is 0.014623705196379143
04/02/2023, 04:47:48: test hit @ 1 is 0.005168829709534244
04/02/2023, 04:47:48: test hit @ 5 is 0.01629305017135794
04/02/2023, 04:47:48: test hit @ 10 is 0.027529636496432384
04/02/2023, 04:47:48: test ncdg @ 5 is 0.010630127797416174
04/02/2023, 04:47:48: test ncdg @ 10 is 0.014256807066781979
04/02/2023, 04:47:48: recall increases from 0.029496039103320413 ----> 0.03769874712062475 at epoch 2
04/02/2023, 04:48:12: test hit @ 1 is 0.002584414854767122
04/02/2023, 04:48:12: test hit @ 5 is 0.012416427889207259
04/02/2023, 04:48:12: test hit @ 10 is 0.02443957525703691
04/02/2023, 04:48:12: test ncdg @ 5 is 0.007305545584645876
04/02/2023, 04:48:12: test ncdg @ 10 is 0.011149923940092512
04/02/2023, 04:48:12: recall increases from 0.023484465419405586 ----> 0.031911905163211414 at epoch 2
04/02/2023, 04:48:12: save current best model to best_model/sports/pretrain_t5_small_sports_content_based.pt
04/02/2023, 04:48:13: ---------- training epoch 3 ----------
04/02/2023, 04:50:05: total loss for 45000 steps : 1144.652766942978
04/02/2023, 04:53:22: total loss for 46000 steps : 1142.8447680473328
04/02/2023, 04:56:39: total loss for 47000 steps : 1139.2110446691513
04/02/2023, 04:59:56: total loss for 48000 steps : 1141.4259841442108
04/02/2023, 05:03:12: total loss for 49000 steps : 1132.6018303632736
04/02/2023, 05:06:28: total loss for 50000 steps : 1131.6045053005219
04/02/2023, 05:09:44: total loss for 51000 steps : 1130.6033742427826
04/02/2023, 05:13:01: total loss for 52000 steps : 1130.1616238355637
04/02/2023, 05:16:18: total loss for 53000 steps : 1126.5355044603348
04/02/2023, 05:19:43: total loss for 54000 steps : 1121.6817930936813
04/02/2023, 05:23:02: total loss for 55000 steps : 1120.3368371725082
04/02/2023, 05:26:20: total loss for 56000 steps : 1119.2536422014236
04/02/2023, 05:29:36: total loss for 57000 steps : 1116.5772801041603
04/02/2023, 05:32:52: total loss for 58000 steps : 1112.1760548353195
04/02/2023, 05:36:07: total loss for 59000 steps : 1112.2479642629623
04/02/2023, 05:37:20: ---------- start evaluation after epoch 3 ----------
04/02/2023, 05:48:19: validation hit @ 1 is 0.010281476487443115
04/02/2023, 05:48:19: validation hit @ 5 is 0.031237709983706948
04/02/2023, 05:48:19: validation hit @ 10 is 0.05073318725771111
04/02/2023, 05:48:19: validation ncdg @ 5 is 0.020726246644572285
04/02/2023, 05:48:19: validation ncdg @ 10 is 0.026994065855212267
04/02/2023, 05:48:25: validation hit @ 1 is 0.00584302488903871
04/02/2023, 05:48:25: validation hit @ 5 is 0.021405696949266813
04/02/2023, 05:48:25: validation hit @ 10 is 0.038035844710376986
04/02/2023, 05:48:25: validation ncdg @ 5 is 0.013552866887040995
04/02/2023, 05:48:25: validation ncdg @ 10 is 0.018871236087803032
04/02/2023, 05:59:17: test hit @ 1 is 0.007079049384796899
04/02/2023, 05:59:17: test hit @ 5 is 0.022248440923647396
04/02/2023, 05:59:17: test hit @ 10 is 0.036013259171863585
04/02/2023, 05:59:17: test ncdg @ 5 is 0.014560040190962563
04/02/2023, 05:59:17: test ncdg @ 10 is 0.018939712238439092
04/02/2023, 05:59:17: recall increases from 0.03769874712062475 ----> 0.05073318725771111 at epoch 3
04/02/2023, 05:59:33: test hit @ 1 is 0.005168829709534244
04/02/2023, 05:59:33: test hit @ 5 is 0.016854879487611663
04/02/2023, 05:59:33: test hit @ 10 is 0.030451148940951737
04/02/2023, 05:59:33: test ncdg @ 5 is 0.010900922654742459
04/02/2023, 05:59:33: test ncdg @ 10 is 0.015214896501060574
04/02/2023, 05:59:33: recall increases from 0.031911905163211414 ----> 0.038035844710376986 at epoch 3
04/02/2023, 05:59:33: save current best model to best_model/sports/pretrain_t5_small_sports_content_based.pt
04/02/2023, 05:59:34: ---------- training epoch 4 ----------
04/02/2023, 06:02:04: total loss for 60000 steps : 1109.9676082134247
04/02/2023, 06:05:20: total loss for 61000 steps : 1106.8814743757248
04/02/2023, 06:08:37: total loss for 62000 steps : 1105.4305576086044
04/02/2023, 06:11:55: total loss for 63000 steps : 1105.0739007592201
04/02/2023, 06:15:11: total loss for 64000 steps : 1099.1732648611069
04/02/2023, 06:18:26: total loss for 65000 steps : 1097.1554390192032
04/02/2023, 06:21:40: total loss for 66000 steps : 1095.0513167977333
04/02/2023, 06:24:57: total loss for 67000 steps : 1093.1399059295654
04/02/2023, 06:28:16: total loss for 68000 steps : 1092.2805281281471
04/02/2023, 06:31:32: total loss for 69000 steps : 1086.752937912941
04/02/2023, 06:34:51: total loss for 70000 steps : 1085.8199506402016
04/02/2023, 06:38:08: total loss for 71000 steps : 1083.197875738144
04/02/2023, 06:41:25: total loss for 72000 steps : 1079.5824058651924
04/02/2023, 06:44:41: total loss for 73000 steps : 1077.4383415579796
04/02/2023, 06:48:00: total loss for 74000 steps : 1075.2654602527618
04/02/2023, 06:48:30: ---------- start evaluation after epoch 4 ----------
04/02/2023, 06:59:22: validation hit @ 1 is 0.013146806000337097
04/02/2023, 06:59:22: validation hit @ 5 is 0.0367998202146188
04/02/2023, 06:59:22: validation hit @ 10 is 0.05489072419798865
04/02/2023, 06:59:22: validation ncdg @ 5 is 0.02499751394260738
04/02/2023, 06:59:22: validation ncdg @ 10 is 0.030820149521936457
04/02/2023, 06:59:37: validation hit @ 1 is 0.010000561829316254
04/02/2023, 06:59:37: validation hit @ 5 is 0.030844429462329345
04/02/2023, 06:59:37: validation hit @ 10 is 0.048092589471318614
04/02/2023, 06:59:37: validation ncdg @ 5 is 0.02029399506511614
04/02/2023, 06:59:37: validation ncdg @ 10 is 0.02583135604933019
04/02/2023, 07:10:18: test hit @ 1 is 0.008708354401932693
04/02/2023, 07:10:18: test hit @ 5 is 0.02309118489802798
04/02/2023, 07:10:18: test hit @ 10 is 0.03753019832574864
04/02/2023, 07:10:18: test ncdg @ 5 is 0.015971498273953177
04/02/2023, 07:10:18: test ncdg @ 10 is 0.020614249355549123
04/02/2023, 07:10:18: recall increases from 0.05073318725771111 ----> 0.05489072419798865 at epoch 4
04/02/2023, 07:10:46: test hit @ 1 is 0.008652171470307321
04/02/2023, 07:10:46: test hit @ 5 is 0.024271026462160797
04/02/2023, 07:10:46: test hit @ 10 is 0.03674363728299343
04/02/2023, 07:10:46: test ncdg @ 5 is 0.01620510680908512
04/02/2023, 07:10:46: test ncdg @ 10 is 0.020238404514056913
04/02/2023, 07:10:46: recall increases from 0.038035844710376986 ----> 0.048092589471318614 at epoch 4
04/02/2023, 07:10:46: save current best model to best_model/sports/pretrain_t5_small_sports_content_based.pt
04/02/2023, 07:10:47: ---------- training epoch 5 ----------
04/02/2023, 07:13:55: total loss for 75000 steps : 1070.853707432747
04/02/2023, 07:17:14: total loss for 76000 steps : 1067.2456051707268
04/02/2023, 07:20:30: total loss for 77000 steps : 1067.3087626695633
04/02/2023, 07:23:48: total loss for 78000 steps : 1063.0035888552666
04/02/2023, 07:27:04: total loss for 79000 steps : 1061.1166679859161
04/02/2023, 07:30:21: total loss for 80000 steps : 1059.2718386650085
04/02/2023, 07:33:35: total loss for 81000 steps : 1057.5494025349617
04/02/2023, 07:36:53: total loss for 82000 steps : 1052.750844836235
04/02/2023, 07:40:09: total loss for 83000 steps : 1048.80281072855
04/02/2023, 07:43:28: total loss for 84000 steps : 1046.0371479988098
04/02/2023, 07:46:47: total loss for 85000 steps : 1042.5155356526375
04/02/2023, 07:50:03: total loss for 86000 steps : 1039.9513505101204
04/02/2023, 07:53:17: total loss for 87000 steps : 1036.6638982892036
04/02/2023, 07:56:33: total loss for 88000 steps : 1035.8069831728935
04/02/2023, 07:59:39: ---------- start evaluation after epoch 5 ----------
04/02/2023, 08:10:35: validation hit @ 1 is 0.014158098769593798
04/02/2023, 08:10:35: validation hit @ 5 is 0.03696836900949491
04/02/2023, 08:10:35: validation hit @ 10 is 0.05663239507837519
04/02/2023, 08:10:35: validation ncdg @ 5 is 0.025600835804051033
04/02/2023, 08:10:35: validation ncdg @ 10 is 0.03196617617133066
04/02/2023, 08:10:47: validation hit @ 1 is 0.011742232709702793
04/02/2023, 08:10:47: validation hit @ 5 is 0.03399067363335019
04/02/2023, 08:10:47: validation hit @ 10 is 0.0509579189842126
04/02/2023, 08:10:47: validation ncdg @ 5 is 0.02301687508094758
04/02/2023, 08:10:47: validation ncdg @ 10 is 0.028423087490964442
04/02/2023, 08:21:35: test hit @ 1 is 0.00938254958143716
04/02/2023, 08:21:35: test hit @ 5 is 0.024720489915163773
04/02/2023, 08:21:35: test hit @ 10 is 0.03764256418899938
04/02/2023, 08:21:35: test ncdg @ 5 is 0.01708018243271096
04/02/2023, 08:21:35: test ncdg @ 10 is 0.021239319564818407
04/02/2023, 08:21:35: recall increases from 0.05489072419798865 ----> 0.05663239507837519 at epoch 5
04/02/2023, 08:22:00: test hit @ 1 is 0.008989269060059554
04/02/2023, 08:22:00: test hit @ 5 is 0.0266868925220518
04/02/2023, 08:22:00: test hit @ 10 is 0.04000224731726502
04/02/2023, 08:22:00: test ncdg @ 5 is 0.017798313515491486
04/02/2023, 08:22:00: test ncdg @ 10 is 0.02205963494834413
04/02/2023, 08:22:00: recall increases from 0.048092589471318614 ----> 0.0509579189842126 at epoch 5
04/02/2023, 08:22:00: save current best model to best_model/sports/pretrain_t5_small_sports_content_based.pt
04/02/2023, 08:22:01: ---------- training epoch 6 ----------
04/02/2023, 08:22:30: total loss for 89000 steps : 1030.3382149934769
04/02/2023, 08:25:48: total loss for 90000 steps : 1026.7737993001938
04/02/2023, 08:29:09: total loss for 91000 steps : 1024.322583079338
04/02/2023, 08:32:28: total loss for 92000 steps : 1019.812594294548
04/02/2023, 08:35:42: total loss for 93000 steps : 1016.9860121011734
04/02/2023, 08:38:58: total loss for 94000 steps : 1015.6490326523781
04/02/2023, 08:42:15: total loss for 95000 steps : 1009.3488410115242
04/02/2023, 08:45:31: total loss for 96000 steps : 1004.6198875308037
04/02/2023, 08:48:48: total loss for 97000 steps : 1000.1126601099968
04/02/2023, 08:52:04: total loss for 98000 steps : 996.4941494464874
04/02/2023, 08:55:21: total loss for 99000 steps : 993.256276011467
04/02/2023, 08:58:37: total loss for 100000 steps : 989.9748165011406
04/02/2023, 09:01:53: total loss for 101000 steps : 987.1168761849403
04/02/2023, 09:05:09: total loss for 102000 steps : 980.6314415335655
04/02/2023, 09:08:26: total loss for 103000 steps : 979.3124383091927
04/02/2023, 09:11:13: ---------- start evaluation after epoch 6 ----------
04/02/2023, 09:22:10: validation hit @ 1 is 0.016068318444856452
04/02/2023, 09:22:10: validation hit @ 5 is 0.04151918647115006
04/02/2023, 09:22:10: validation hit @ 10 is 0.05685712680487668
04/02/2023, 09:22:10: validation ncdg @ 5 is 0.02884511089386491
04/02/2023, 09:22:10: validation ncdg @ 10 is 0.03378786190030127
04/02/2023, 09:22:19: validation hit @ 1 is 0.01269734254733412
04/02/2023, 09:22:19: validation hit @ 5 is 0.036013259171863585
04/02/2023, 09:22:19: validation hit @ 10 is 0.052250126411596154
04/02/2023, 09:22:19: validation ncdg @ 5 is 0.024399683347903288
04/02/2023, 09:22:19: validation ncdg @ 10 is 0.029643677151265653
04/02/2023, 09:33:11: test hit @ 1 is 0.010337659419068487
04/02/2023, 09:33:11: test hit @ 5 is 0.025787965616045846
04/02/2023, 09:33:11: test hit @ 10 is 0.038260576436878475
04/02/2023, 09:33:11: test ncdg @ 5 is 0.018219423215442315
04/02/2023, 09:33:11: test ncdg @ 10 is 0.02222323144489973
04/02/2023, 09:33:11: recall increases from 0.05663239507837519 ----> 0.05685712680487668 at epoch 6
04/02/2023, 09:33:29: test hit @ 1 is 0.011517500983201303
04/02/2023, 09:33:29: test hit @ 5 is 0.029102758581942806
04/02/2023, 09:33:29: test hit @ 10 is 0.04297994269340974
04/02/2023, 09:33:29: test ncdg @ 5 is 0.020393809555492474
04/02/2023, 09:33:29: test ncdg @ 10 is 0.02484709083005175
04/02/2023, 09:33:29: recall increases from 0.0509579189842126 ----> 0.052250126411596154 at epoch 6
04/02/2023, 09:33:29: save current best model to best_model/sports/pretrain_t5_small_sports_content_based.pt
04/02/2023, 09:33:30: ---------- training epoch 7 ----------
04/02/2023, 09:34:36: total loss for 104000 steps : 974.0931186676025
04/02/2023, 09:37:52: total loss for 105000 steps : 967.8339822888374
04/02/2023, 09:41:05: total loss for 106000 steps : 964.2621601819992
04/02/2023, 09:44:21: total loss for 107000 steps : 958.9749376773834
04/02/2023, 09:47:36: total loss for 108000 steps : 955.4083538651466
04/02/2023, 09:50:52: total loss for 109000 steps : 950.5078381299973
04/02/2023, 09:54:12: total loss for 110000 steps : 947.148975789547
04/02/2023, 09:57:28: total loss for 111000 steps : 943.1229102015495
04/02/2023, 10:00:44: total loss for 112000 steps : 936.3809407949448
04/02/2023, 10:04:02: total loss for 113000 steps : 930.2918018102646
04/02/2023, 10:07:18: total loss for 114000 steps : 928.4199569225311
04/02/2023, 10:10:36: total loss for 115000 steps : 921.8123406171799
04/02/2023, 10:13:52: total loss for 116000 steps : 920.168634057045
04/02/2023, 10:17:09: total loss for 117000 steps : 910.093523979187
04/02/2023, 10:20:25: total loss for 118000 steps : 907.7454609274864
04/02/2023, 10:22:28: ---------- start evaluation after epoch 7 ----------
04/02/2023, 10:33:26: validation hit @ 1 is 0.013371537726838587
04/02/2023, 10:33:26: validation hit @ 5 is 0.035732344513736726
04/02/2023, 10:33:26: validation hit @ 10 is 0.051744480026967805
04/02/2023, 10:33:26: validation ncdg @ 5 is 0.024537607403843
04/02/2023, 10:33:26: validation ncdg @ 10 is 0.029695600160783937
04/02/2023, 10:33:36: validation hit @ 1 is 0.014832293949098263
04/02/2023, 10:33:36: validation hit @ 5 is 0.03590089330861285
04/02/2023, 10:33:36: validation hit @ 10 is 0.05185684589021855
04/02/2023, 10:33:36: validation ncdg @ 5 is 0.02550430165628717
04/02/2023, 10:33:36: validation ncdg @ 10 is 0.03062081525365609
04/02/2023, 10:44:27: test hit @ 1 is 0.008652171470307321
04/02/2023, 10:44:27: test hit @ 5 is 0.023203550761278724
04/02/2023, 10:44:27: test hit @ 10 is 0.033934490701724815
04/02/2023, 10:44:27: test ncdg @ 5 is 0.016022091362946717
04/02/2023, 10:44:27: test ncdg @ 10 is 0.019448212567687802
04/02/2023, 10:44:45: test hit @ 1 is 0.011348952188325186
04/02/2023, 10:44:45: test hit @ 5 is 0.029664587898196527
04/02/2023, 10:44:45: test hit @ 10 is 0.04269902803528288
04/02/2023, 10:44:45: test ncdg @ 5 is 0.020649883641316348
04/02/2023, 10:44:45: test ncdg @ 10 is 0.02488325921859146
04/02/2023, 10:44:45: ---------- training epoch 8 ----------
04/02/2023, 10:46:31: total loss for 119000 steps : 900.8922390341759
04/02/2023, 10:49:48: total loss for 120000 steps : 895.9959942698479
04/02/2023, 10:53:06: total loss for 121000 steps : 891.8849251270294
04/02/2023, 10:56:25: total loss for 122000 steps : 887.1572093367577
04/02/2023, 10:59:48: total loss for 123000 steps : 880.0281884670258
04/02/2023, 11:03:06: total loss for 124000 steps : 874.2668346762657
04/02/2023, 11:06:24: total loss for 125000 steps : 872.5010185241699
04/02/2023, 11:09:44: total loss for 126000 steps : 865.7312713265419
04/02/2023, 11:13:03: total loss for 127000 steps : 861.5853416919708
04/02/2023, 11:16:20: total loss for 128000 steps : 855.8603382110596
04/02/2023, 11:19:42: total loss for 129000 steps : 847.9484096765518
04/02/2023, 11:23:05: total loss for 130000 steps : 843.779085457325
04/02/2023, 11:26:23: total loss for 131000 steps : 837.0057879090309
04/02/2023, 11:29:41: total loss for 132000 steps : 833.5786594748497
04/02/2023, 11:33:01: total loss for 133000 steps : 827.3804349303246
04/02/2023, 11:33:56: ---------- start evaluation after epoch 8 ----------
04/02/2023, 11:44:52: validation hit @ 1 is 0.011068037530198326
04/02/2023, 11:44:52: validation hit @ 5 is 0.03281083206921737
04/02/2023, 11:44:52: validation hit @ 10 is 0.047643126018315635
04/02/2023, 11:44:52: validation ncdg @ 5 is 0.021879732456723797
04/02/2023, 11:44:52: validation ncdg @ 10 is 0.026647560976403695
04/02/2023, 11:45:05: validation hit @ 1 is 0.014326647564469915
04/02/2023, 11:45:05: validation hit @ 5 is 0.036687454351368054
04/02/2023, 11:45:05: validation hit @ 10 is 0.052250126411596154
04/02/2023, 11:45:05: validation ncdg @ 5 is 0.025629108720163874
04/02/2023, 11:45:05: validation ncdg @ 10 is 0.03060629868655284
04/02/2023, 11:55:55: test hit @ 1 is 0.006966683521546154
04/02/2023, 11:55:55: test hit @ 5 is 0.020169672453508623
04/02/2023, 11:55:55: test hit @ 10 is 0.030338783077700996
04/02/2023, 11:55:55: test ncdg @ 5 is 0.013644295822697387
04/02/2023, 11:55:55: test ncdg @ 10 is 0.016891746872266317
04/02/2023, 11:56:18: test hit @ 1 is 0.010337659419068487
04/02/2023, 11:56:18: test hit @ 5 is 0.028316197539187595
04/02/2023, 11:56:18: test hit @ 10 is 0.03955278386426204
04/02/2023, 11:56:18: test ncdg @ 5 is 0.019403089877265675
04/02/2023, 11:56:18: test ncdg @ 10 is 0.02299092401916291
04/02/2023, 11:56:18: ---------- training epoch 9 ----------
04/02/2023, 11:58:41: total loss for 134000 steps : 818.9861116409302
04/02/2023, 12:01:57: total loss for 135000 steps : 814.5935971736908
04/02/2023, 12:05:15: total loss for 136000 steps : 806.808505654335
04/02/2023, 12:08:32: total loss for 137000 steps : 801.1869860887527
04/02/2023, 12:11:51: total loss for 138000 steps : 796.9597917199135
04/02/2023, 12:15:10: total loss for 139000 steps : 792.9017162919044
04/02/2023, 12:18:26: total loss for 140000 steps : 783.9984800815582
04/02/2023, 12:21:43: total loss for 141000 steps : 779.8548721075058
04/02/2023, 12:25:02: total loss for 142000 steps : 774.4905131459236
04/02/2023, 12:28:20: total loss for 143000 steps : 767.8080323934555
04/02/2023, 12:31:43: total loss for 144000 steps : 764.5474977493286
04/02/2023, 12:35:02: total loss for 145000 steps : 755.7927252054214
04/02/2023, 12:38:19: total loss for 146000 steps : 750.9785214066505
04/02/2023, 12:41:37: total loss for 147000 steps : 743.542022228241
04/02/2023, 12:44:54: total loss for 148000 steps : 739.9401876926422
04/02/2023, 12:45:17: ---------- start evaluation after epoch 9 ----------
04/02/2023, 12:56:14: validation hit @ 1 is 0.009494915444687904
04/02/2023, 12:56:14: validation hit @ 5 is 0.026518343727175684
04/02/2023, 12:56:14: validation hit @ 10 is 0.0398336985223889
04/02/2023, 12:56:14: validation ncdg @ 5 is 0.018219920567943176
04/02/2023, 12:56:14: validation ncdg @ 10 is 0.022512781563230264
04/02/2023, 12:56:26: validation hit @ 1 is 0.013034440137086354
04/02/2023, 12:56:26: validation hit @ 5 is 0.03449632001797854
04/02/2023, 12:56:26: validation hit @ 10 is 0.05045227259958425
04/02/2023, 12:56:26: validation ncdg @ 5 is 0.02394278409032621
04/02/2023, 12:56:26: validation ncdg @ 10 is 0.029061155569814978
04/02/2023, 13:07:14: test hit @ 1 is 0.005112646777908871
04/02/2023, 13:07:14: test hit @ 5 is 0.018428001573122084
04/02/2023, 13:07:14: test hit @ 10 is 0.02943985617169504
04/02/2023, 13:07:14: test ncdg @ 5 is 0.011833403413915655
04/02/2023, 13:07:14: test ncdg @ 10 is 0.015376425584109912
04/02/2023, 13:07:38: test hit @ 1 is 0.010281476487443115
04/02/2023, 13:07:38: test hit @ 5 is 0.026743075453677174
04/02/2023, 13:07:38: test hit @ 10 is 0.03865385695825608
04/02/2023, 13:07:38: test ncdg @ 5 is 0.018742941259370993
04/02/2023, 13:07:38: test ncdg @ 10 is 0.02254126471006436
04/02/2023, 13:07:38: ---------- training epoch 10 ----------
04/02/2023, 13:10:36: total loss for 149000 steps : 732.1207975745201
04/02/2023, 13:13:56: total loss for 150000 steps : 726.8047339916229
04/02/2023, 13:17:16: total loss for 151000 steps : 720.611202120781
04/02/2023, 13:20:33: total loss for 152000 steps : 715.106482565403
04/02/2023, 13:23:50: total loss for 153000 steps : 708.5698541402817
04/02/2023, 13:27:09: total loss for 154000 steps : 701.9138150811195
04/02/2023, 13:30:25: total loss for 155000 steps : 695.4169870018959
04/02/2023, 13:33:43: total loss for 156000 steps : 691.8995046019554
04/02/2023, 13:37:04: total loss for 157000 steps : 687.6284487247467
04/02/2023, 13:40:19: total loss for 158000 steps : 680.6313900947571
04/02/2023, 13:43:36: total loss for 159000 steps : 673.2476580739021
04/02/2023, 13:46:52: total loss for 160000 steps : 666.611544072628
04/02/2023, 13:50:06: total loss for 161000 steps : 660.4301838874817
04/02/2023, 13:53:26: total loss for 162000 steps : 657.4667113423347
04/02/2023, 13:56:37: ---------- start evaluation after epoch 10 ----------
04/02/2023, 14:07:34: validation hit @ 1 is 0.008034159222428226
04/02/2023, 14:07:34: validation hit @ 5 is 0.024495758188662283
04/02/2023, 14:07:34: validation hit @ 10 is 0.03786729591550087
04/02/2023, 14:07:34: validation ncdg @ 5 is 0.01630471274172623
04/02/2023, 14:07:34: validation ncdg @ 10 is 0.020592811582301963
04/02/2023, 14:07:45: validation hit @ 1 is 0.009551098376313277
04/02/2023, 14:07:45: validation hit @ 5 is 0.0297207708298219
04/02/2023, 14:07:45: validation hit @ 10 is 0.045114894095173885
04/02/2023, 14:07:45: validation ncdg @ 5 is 0.019910034109188735
04/02/2023, 14:07:45: validation ncdg @ 10 is 0.024879710202020535
04/02/2023, 14:18:37: test hit @ 1 is 0.004550817461655149
04/02/2023, 14:18:37: test hit @ 5 is 0.015562672060228103
04/02/2023, 14:18:37: test hit @ 10 is 0.02511377043654138
04/02/2023, 14:18:37: test ncdg @ 5 is 0.010155673200732367
04/02/2023, 14:18:37: test ncdg @ 10 is 0.013225296342019027
04/02/2023, 14:18:57: test hit @ 1 is 0.007921793359177481
04/02/2023, 14:18:57: test hit @ 5 is 0.02309118489802798
04/02/2023, 14:18:57: test hit @ 10 is 0.034383954154727794
04/02/2023, 14:18:57: test ncdg @ 5 is 0.0157750017715999
04/02/2023, 14:18:57: test ncdg @ 10 is 0.019396602095644914
04/02/2023, 14:18:57: ---------- training epoch 11 ----------
04/02/2023, 14:19:17: total loss for 163000 steps : 649.3886475563049
04/02/2023, 14:22:32: total loss for 164000 steps : 641.8958002328873
