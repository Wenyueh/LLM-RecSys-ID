04/12/2023, 18:22:54: Namespace(seed=2022, data_dir='data/', logging_dir='log/yelp/pretrain_t5_small_yelp_sequential_original.log', model_dir='model/yelp/pretrain_t5_small_yelp_sequential_original.pt', task='yelp', max_history=20, sequential_num=10, negative_sample=2, yes_no_sample=5, direct_item_proportion=2, train_sequential_item_batch=64, train_sequential_yesno_batch=32, train_direct_yesno_batch=48, train_direct_candidate_batch=12, train_direct_straightforward_batch=48, meta_title_batch=128, meta_description_batch=12, meta_category_batch=128, meta_epochs=10, meta_lr=0.0001, review_user_batch=16, review_item_batch=16, review_epochs=2, review_lr=0.0001, model_type='t5-small', epochs=20, lr=0.001, clip=1.0, logging_step=1000, warmup_prop=0.05, gradient_accumulation_steps=1, weight_decay=0.01, adam_eps=1e-06, dropout=0.1, alpha=2, multiGPU=True, distributed=True, gpu='0,3', local_rank=0, evaluation_method='sequential_item', evaluation_template_id=0, number_of_items=20034, item_representation='None', cluster_number=55, cluster_size=100, optimal_width_in_CF=False, category_no_repetition=False, last_token_no_repetition=False, hybrid_order='CF_first', data_order='remapped_sequential', remapped_data_order='original', resolution=2, max_random_number=30000, min_random_number=1000, overlap=0, base=10, random_initialization_embedding=True, whole_word_embedding='shijie', no_pretrain=False, use_meta_data=False, use_review_data=False, remove_last_item=False, remove_first_item=False, eval_only=False, check_data=False)
04/12/2023, 18:23:15: Process Launching at GPU 0
04/12/2023, 18:23:15: Process Launching at GPU 1
04/12/2023, 18:23:16: Building train loader at GPU 1
04/12/2023, 18:23:16: Building train loader at GPU 0
04/12/2023, 18:23:16: loading data ...
04/12/2023, 18:23:17: finished loading data
04/12/2023, 18:23:17: length of training data is 17583
04/12/2023, 18:23:17: loading model ...
04/12/2023, 18:23:17: using only sequential data, and all possible sequences are here
04/12/2023, 18:23:17: use pretrained T5
04/12/2023, 18:23:18: randomly initialize number-related embeddings only
04/12/2023, 18:23:26: Batch per epoch: 17583
04/12/2023, 18:23:26: Total steps: 351660
04/12/2023, 18:23:26: Warmup proportion:
04/12/2023, 18:23:26: Warm up steps: 17583
04/12/2023, 18:23:29: model dataparallel set
04/12/2023, 18:23:30: start training
04/12/2023, 18:23:30: ---------- training epoch 0 ----------
04/12/2023, 18:26:22: total loss for 1000 steps : 3816.3578124046326
04/12/2023, 18:29:18: total loss for 2000 steps : 2308.54284119606
04/12/2023, 18:32:02: total loss for 3000 steps : 2202.1770961284637
04/12/2023, 18:34:42: total loss for 4000 steps : 2121.6345615386963
04/12/2023, 18:37:12: total loss for 5000 steps : 2070.1532357931137
04/12/2023, 18:39:43: total loss for 6000 steps : 2036.3289251327515
04/12/2023, 18:42:10: total loss for 7000 steps : 2007.9640107154846
04/12/2023, 18:44:41: total loss for 8000 steps : 1983.7230973243713
04/12/2023, 18:47:11: total loss for 9000 steps : 1962.1736246347427
04/12/2023, 18:49:41: total loss for 10000 steps : 1943.0143897533417
04/12/2023, 18:52:11: total loss for 11000 steps : 1922.554149031639
04/12/2023, 18:54:57: total loss for 12000 steps : 1900.1583302021027
04/12/2023, 18:58:52: total loss for 13000 steps : 1871.8347735404968
04/12/2023, 19:02:56: total loss for 14000 steps : 1842.341070175171
04/12/2023, 19:06:56: total loss for 15000 steps : 1815.9313634634018
04/12/2023, 19:09:39: total loss for 16000 steps : 1794.4937233924866
04/12/2023, 19:12:26: total loss for 17000 steps : 1781.4589784145355
04/12/2023, 19:33:35: ---------- start evaluation after epoch 0 ----------
04/12/2023, 19:42:57: validation hit @ 1 is 0.004929022082018927
04/12/2023, 19:42:57: validation hit @ 5 is 0.018796004206098844
04/12/2023, 19:42:57: validation hit @ 10 is 0.028982649842271294
04/12/2023, 19:42:57: validation ncdg @ 5 is 0.012037644000621697
04/12/2023, 19:42:57: validation ncdg @ 10 is 0.015323281839379583
04/12/2023, 19:51:46: test hit @ 1 is 0.004534700315457414
04/12/2023, 19:51:46: test hit @ 5 is 0.016232912723449
04/12/2023, 19:51:46: test hit @ 10 is 0.025433753943217667
04/12/2023, 19:51:46: test ncdg @ 5 is 0.010662944140769584
04/12/2023, 19:51:46: test ncdg @ 10 is 0.013623407157776518
04/12/2023, 19:51:46: recall increases from 0 ----> 0.028982649842271294 at epoch 0
04/12/2023, 19:51:46: save current best model to best_model/yelp/pretrain_t5_small_yelp_sequential_original.pt
04/12/2023, 20:49:44: validation hit @ 1 is 0.005257623554153523
04/12/2023, 20:49:44: validation hit @ 5 is 0.017415878023133543
04/12/2023, 20:49:44: validation hit @ 10 is 0.02569663512092534
04/12/2023, 20:49:44: validation ncdg @ 5 is 0.011528521373753936
04/12/2023, 20:49:44: validation ncdg @ 10 is 0.014191346617439062
04/12/2023, 21:14:39: test hit @ 1 is 0.0048633017875920085
04/12/2023, 21:14:39: test hit @ 5 is 0.01570715036803365
04/12/2023, 21:14:39: test hit @ 10 is 0.025893796004206097
04/12/2023, 21:14:39: test ncdg @ 5 is 0.010411026855996654
04/12/2023, 21:14:39: test ncdg @ 10 is 0.013667074851346555
04/12/2023, 21:14:39: recall increases from 0 ----> 0.02569663512092534 at epoch 0
04/12/2023, 21:14:39: ---------- training epoch 1 ----------
04/12/2023, 21:16:03: total loss for 18000 steps : 1765.3314017057419
04/12/2023, 21:20:37: total loss for 19000 steps : 1748.2534464597702
04/12/2023, 21:25:15: total loss for 20000 steps : 1734.6277921199799
04/12/2023, 21:28:59: total loss for 21000 steps : 1718.7964477539062
04/12/2023, 21:32:40: total loss for 22000 steps : 1707.3215633630753
04/12/2023, 21:35:47: total loss for 23000 steps : 1693.1716322898865
04/12/2023, 21:39:04: total loss for 24000 steps : 1684.9308360815048
04/12/2023, 21:42:03: total loss for 25000 steps : 1669.7553936243057
04/12/2023, 21:45:12: total loss for 26000 steps : 1663.6038683652878
04/12/2023, 21:48:43: total loss for 27000 steps : 1654.4588482379913
04/12/2023, 21:52:18: total loss for 28000 steps : 1644.7158433198929
04/12/2023, 21:56:40: total loss for 29000 steps : 1640.475925564766
04/12/2023, 22:00:56: total loss for 30000 steps : 1629.0045320987701
04/12/2023, 22:04:01: total loss for 31000 steps : 1623.7760504484177
04/12/2023, 22:07:11: total loss for 32000 steps : 1619.0365294218063
04/12/2023, 22:09:53: total loss for 33000 steps : 1609.1440593004227
04/12/2023, 22:13:04: total loss for 34000 steps : 1605.7703770399094
04/12/2023, 22:16:06: total loss for 35000 steps : 1599.026285290718
04/12/2023, 22:27:34: ---------- start evaluation after epoch 1 ----------
04/12/2023, 22:36:52: validation hit @ 1 is 0.01025236593059937
04/12/2023, 22:36:52: validation hit @ 5 is 0.028654048370136697
04/12/2023, 22:36:52: validation hit @ 10 is 0.04206098843322818
04/12/2023, 22:36:52: validation ncdg @ 5 is 0.019495613300140206
04/12/2023, 22:36:52: validation ncdg @ 10 is 0.02380556760120016
04/12/2023, 22:46:08: test hit @ 1 is 0.009858044164037854
04/12/2023, 22:46:08: test hit @ 5 is 0.02714248159831756
04/12/2023, 22:46:08: test hit @ 10 is 0.038643533123028394
04/12/2023, 22:46:08: test ncdg @ 5 is 0.018563662816955203
04/12/2023, 22:46:08: test ncdg @ 10 is 0.022234437767977594
04/12/2023, 22:46:08: recall increases from 0.028982649842271294 ----> 0.04206098843322818 at epoch 1
04/12/2023, 22:46:08: save current best model to best_model/yelp/pretrain_t5_small_yelp_sequential_original.pt
04/12/2023, 23:17:13: validation hit @ 1 is 0.009858044164037854
04/12/2023, 23:17:13: validation hit @ 5 is 0.02714248159831756
04/12/2023, 23:17:13: validation hit @ 10 is 0.038577812828601475
04/12/2023, 23:17:13: validation ncdg @ 5 is 0.018601552222696445
04/12/2023, 23:17:13: validation ncdg @ 10 is 0.022301509184447763
04/12/2023, 23:25:58: test hit @ 1 is 0.011961093585699264
04/12/2023, 23:25:58: test hit @ 5 is 0.02858832807570978
04/12/2023, 23:25:58: test hit @ 10 is 0.041666666666666664
04/12/2023, 23:25:58: test ncdg @ 5 is 0.020501636451077387
04/12/2023, 23:25:58: test ncdg @ 10 is 0.024728728800687088
04/12/2023, 23:25:58: recall increases from 0.02569663512092534 ----> 0.038577812828601475 at epoch 1
04/12/2023, 23:25:58: ---------- training epoch 2 ----------
04/12/2023, 23:27:56: total loss for 36000 steps : 1591.896456360817
04/12/2023, 23:30:16: total loss for 37000 steps : 1588.606579899788
04/12/2023, 23:32:42: total loss for 38000 steps : 1577.612424492836
04/12/2023, 23:35:08: total loss for 39000 steps : 1580.9616675376892
04/12/2023, 23:37:35: total loss for 40000 steps : 1576.7075054645538
04/12/2023, 23:40:02: total loss for 41000 steps : 1569.0434906482697
04/12/2023, 23:42:28: total loss for 42000 steps : 1561.8264466524124
04/12/2023, 23:44:51: total loss for 43000 steps : 1559.121029496193
04/12/2023, 23:47:10: total loss for 44000 steps : 1551.6413317918777
04/12/2023, 23:49:38: total loss for 45000 steps : 1546.4481018781662
04/12/2023, 23:52:07: total loss for 46000 steps : 1546.4293735027313
04/12/2023, 23:54:39: total loss for 47000 steps : 1539.938475370407
04/12/2023, 23:57:09: total loss for 48000 steps : 1538.2637127637863
04/12/2023, 23:59:41: total loss for 49000 steps : 1531.688379406929
04/13/2023, 00:02:04: total loss for 50000 steps : 1527.7853254079819
04/13/2023, 00:04:26: total loss for 51000 steps : 1527.1835280656815
04/13/2023, 00:06:47: total loss for 52000 steps : 1516.308975815773
04/13/2023, 00:09:18: ---------- start evaluation after epoch 2 ----------
04/13/2023, 00:18:09: validation hit @ 1 is 0.012355415352260778
04/13/2023, 00:18:10: validation hit @ 5 is 0.033123028391167195
04/13/2023, 00:18:10: validation hit @ 10 is 0.047055730809674026
04/13/2023, 00:18:10: validation ncdg @ 5 is 0.02298580447811756
04/13/2023, 00:18:10: validation ncdg @ 10 is 0.027455902957808937
04/13/2023, 00:18:10: validation hit @ 1 is 0.013012618296529969
04/13/2023, 00:18:10: validation hit @ 5 is 0.032268664563617246
04/13/2023, 00:18:10: validation hit @ 10 is 0.045807045215562565
04/13/2023, 00:18:10: validation ncdg @ 5 is 0.023025157611685405
04/13/2023, 00:18:10: validation ncdg @ 10 is 0.0273609695086109
04/13/2023, 00:26:53: test hit @ 1 is 0.014392744479495269
04/13/2023, 00:26:53: test hit @ 5 is 0.03456887486855941
04/13/2023, 00:26:53: test hit @ 10 is 0.04692429022082019
04/13/2023, 00:26:53: test ncdg @ 5 is 0.02478384637421656
04/13/2023, 00:26:53: test ncdg @ 10 is 0.028729866251281707
04/13/2023, 00:26:53: recall increases from 0.038577812828601475 ----> 0.045807045215562565 at epoch 2
04/13/2023, 00:26:59: test hit @ 1 is 0.012158254468980022
04/13/2023, 00:26:59: test hit @ 5 is 0.03456887486855941
04/13/2023, 00:26:59: test hit @ 10 is 0.05027602523659306
04/13/2023, 00:26:59: test ncdg @ 5 is 0.02365442281611808
04/13/2023, 00:26:59: test ncdg @ 10 is 0.028701113559305314
04/13/2023, 00:26:59: recall increases from 0.04206098843322818 ----> 0.047055730809674026 at epoch 2
04/13/2023, 00:26:59: save current best model to best_model/yelp/pretrain_t5_small_yelp_sequential_original.pt
04/13/2023, 00:27:43: ---------- training epoch 3 ----------
04/13/2023, 00:28:20: total loss for 53000 steps : 1517.4666103124619
04/13/2023, 00:30:46: total loss for 54000 steps : 1508.618674993515
04/13/2023, 00:33:10: total loss for 55000 steps : 1503.4514027833939
04/13/2023, 00:35:30: total loss for 56000 steps : 1500.1341737508774
04/13/2023, 00:37:48: total loss for 57000 steps : 1495.0656374692917
04/13/2023, 00:40:14: total loss for 58000 steps : 1491.4545871019363
04/13/2023, 00:42:36: total loss for 59000 steps : 1490.0611834526062
04/13/2023, 00:45:00: total loss for 60000 steps : 1488.2941938638687
04/13/2023, 00:47:26: total loss for 61000 steps : 1482.9686127901077
04/13/2023, 00:49:52: total loss for 62000 steps : 1474.230902314186
04/13/2023, 00:52:14: total loss for 63000 steps : 1475.26571059227
04/13/2023, 00:54:41: total loss for 64000 steps : 1466.9598684310913
04/13/2023, 00:57:13: total loss for 65000 steps : 1462.780826807022
04/13/2023, 00:59:45: total loss for 66000 steps : 1459.5335438251495
04/13/2023, 01:02:14: total loss for 67000 steps : 1454.1782133579254
04/13/2023, 01:04:46: total loss for 68000 steps : 1448.3914272785187
04/13/2023, 01:07:17: total loss for 69000 steps : 1443.6912902593613
04/13/2023, 01:09:40: total loss for 70000 steps : 1441.921184182167
04/13/2023, 01:10:30: ---------- start evaluation after epoch 3 ----------
04/13/2023, 01:19:04: validation hit @ 1 is 0.012552576235541535
04/13/2023, 01:19:04: validation hit @ 5 is 0.03161146161934805
04/13/2023, 01:19:04: validation hit @ 10 is 0.04758149316508938
04/13/2023, 01:19:04: validation ncdg @ 5 is 0.02225151169735363
04/13/2023, 01:19:04: validation ncdg @ 10 is 0.027363079919860048
04/13/2023, 01:19:18: validation hit @ 1 is 0.012092534174553101
04/13/2023, 01:19:18: validation hit @ 5 is 0.03470031545741325
04/13/2023, 01:19:18: validation hit @ 10 is 0.050078864353312304
04/13/2023, 01:19:18: validation ncdg @ 5 is 0.023578954339141516
04/13/2023, 01:19:18: validation ncdg @ 10 is 0.028482280644042218
04/13/2023, 01:27:38: test hit @ 1 is 0.01288117770767613
04/13/2023, 01:27:38: test hit @ 5 is 0.03325446898002103
04/13/2023, 01:27:38: test hit @ 10 is 0.04817297581493165
04/13/2023, 01:27:38: test ncdg @ 5 is 0.023325348042469787
04/13/2023, 01:27:38: test ncdg @ 10 is 0.028154104002686874
04/13/2023, 01:27:38: recall increases from 0.045807045215562565 ----> 0.04758149316508938 at epoch 3
04/13/2023, 01:28:02: test hit @ 1 is 0.011763932702418507
04/13/2023, 01:28:02: test hit @ 5 is 0.032728706624605676
04/13/2023, 01:28:02: test hit @ 10 is 0.04758149316508938
04/13/2023, 01:28:02: test ncdg @ 5 is 0.022617369873637945
04/13/2023, 01:28:02: test ncdg @ 10 is 0.027357639227985356
04/13/2023, 01:28:02: recall increases from 0.047055730809674026 ----> 0.050078864353312304 at epoch 3
04/13/2023, 01:28:02: save current best model to best_model/yelp/pretrain_t5_small_yelp_sequential_original.pt
04/13/2023, 01:28:20: ---------- training epoch 4 ----------
04/13/2023, 01:29:58: total loss for 71000 steps : 1434.013435602188
04/13/2023, 01:32:21: total loss for 72000 steps : 1430.6868218183517
04/13/2023, 01:34:44: total loss for 73000 steps : 1426.3587987422943
04/13/2023, 01:37:08: total loss for 74000 steps : 1417.856056213379
04/13/2023, 01:39:31: total loss for 75000 steps : 1417.4245709180832
04/13/2023, 01:41:53: total loss for 76000 steps : 1406.991794347763
04/13/2023, 01:44:21: total loss for 77000 steps : 1409.0124213695526
04/13/2023, 01:46:50: total loss for 78000 steps : 1399.0762114524841
04/13/2023, 01:49:19: total loss for 79000 steps : 1401.9912717342377
04/13/2023, 01:51:45: total loss for 80000 steps : 1394.5927846431732
04/13/2023, 01:54:14: total loss for 81000 steps : 1390.1654658317566
04/13/2023, 01:56:40: total loss for 82000 steps : 1385.7096771001816
04/13/2023, 01:59:06: total loss for 83000 steps : 1375.120057940483
04/13/2023, 02:01:35: total loss for 84000 steps : 1373.1174691915512
04/13/2023, 02:04:02: total loss for 85000 steps : 1369.031838297844
04/13/2023, 02:06:31: total loss for 86000 steps : 1358.8392394781113
04/13/2023, 02:09:15: total loss for 87000 steps : 1356.9677206277847
04/13/2023, 02:11:32: ---------- start evaluation after epoch 4 ----------
04/13/2023, 02:20:50: validation hit @ 1 is 0.012749737118822293
04/13/2023, 02:20:50: validation hit @ 5 is 0.032794426919032595
04/13/2023, 02:20:50: validation hit @ 10 is 0.047910094637223975
04/13/2023, 02:20:50: validation ncdg @ 5 is 0.022826091763974855
04/13/2023, 02:20:50: validation ncdg @ 10 is 0.027645088314727555
04/13/2023, 02:32:39: test hit @ 1 is 0.011435331230283912
04/13/2023, 02:32:42: test hit @ 5 is 0.02977129337539432
04/13/2023, 02:32:42: test hit @ 10 is 0.04396687697160883
04/13/2023, 02:32:43: test ncdg @ 5 is 0.020944508093817343
04/13/2023, 02:32:43: test ncdg @ 10 is 0.02550930124799399
