04/13/2023, 02:18:49: Namespace(seed=2022, data_dir='data/', logging_dir='log/yelp/pretrain_t5_small_yelp_CF_200_20_norep.log', model_dir='model/yelp/pretrain_t5_small_yelp_CF_200_20_norep.pt', task='yelp', max_history=20, sequential_num=10, negative_sample=2, yes_no_sample=5, direct_item_proportion=2, train_sequential_item_batch=64, train_sequential_yesno_batch=32, train_direct_yesno_batch=48, train_direct_candidate_batch=12, train_direct_straightforward_batch=48, meta_title_batch=128, meta_description_batch=12, meta_category_batch=128, meta_epochs=10, meta_lr=0.0001, review_user_batch=16, review_item_batch=16, review_epochs=2, review_lr=0.0001, model_type='t5-small', epochs=20, lr=0.0005, clip=1.0, logging_step=1000, warmup_prop=0.05, gradient_accumulation_steps=1, weight_decay=0.01, adam_eps=1e-06, dropout=0.1, alpha=2, multiGPU=True, distributed=True, gpu='4,5', local_rank=0, evaluation_method='sequential_item', evaluation_template_id=0, number_of_items=20034, item_representation='CF', cluster_number=20, cluster_size=200, optimal_width_in_CF=False, category_no_repetition=False, last_token_no_repetition=True, hybrid_order='CF_first', data_order='remapped_sequential', remapped_data_order='original', resolution=2, max_random_number=30000, min_random_number=1000, overlap=0, base=10, random_initialization_embedding=False, whole_word_embedding='shijie', no_pretrain=False, use_meta_data=False, use_review_data=False, remove_last_item=False, remove_first_item=False, eval_only=False, check_data=False)
04/13/2023, 02:19:07: Process Launching at GPU 0
04/13/2023, 02:19:07: Process Launching at GPU 1
04/13/2023, 02:19:07: Building train loader at GPU 0
04/13/2023, 02:19:07: loading data ...
04/13/2023, 02:19:07: Building train loader at GPU 1
04/13/2023, 02:19:07: *** use collaborative_filtering_based representation, extend vocab ***
04/13/2023, 02:19:08: finished loading data
04/13/2023, 02:19:08: length of training data is 17583
04/13/2023, 02:19:08: loading model ...
04/13/2023, 02:19:08: using only sequential data, and all possible sequences are here
04/13/2023, 02:19:08: use pretrained T5
04/13/2023, 02:19:14: Batch per epoch: 17583
04/13/2023, 02:19:14: Total steps: 351660
04/13/2023, 02:19:14: Warmup proportion:
04/13/2023, 02:19:14: Warm up steps: 17583
04/13/2023, 02:19:14: model dataparallel set
04/13/2023, 02:19:14: start training
04/13/2023, 02:19:14: ---------- training epoch 0 ----------
04/13/2023, 02:22:01: total loss for 1000 steps : 6867.808963298798
04/13/2023, 02:24:48: total loss for 2000 steps : 4865.385670661926
04/13/2023, 02:27:36: total loss for 3000 steps : 4419.095123291016
04/13/2023, 02:30:24: total loss for 4000 steps : 3961.8221929073334
04/13/2023, 02:33:11: total loss for 5000 steps : 3499.387165784836
04/13/2023, 02:35:59: total loss for 6000 steps : 3091.3067502975464
04/13/2023, 02:38:46: total loss for 7000 steps : 2775.6548643112183
04/13/2023, 02:41:30: total loss for 8000 steps : 2563.203082561493
04/13/2023, 02:44:14: total loss for 9000 steps : 2418.8279008865356
04/13/2023, 02:47:01: total loss for 10000 steps : 2315.1069462299347
04/13/2023, 02:49:45: total loss for 11000 steps : 2237.849290370941
04/13/2023, 02:52:31: total loss for 12000 steps : 2168.2361826896667
04/13/2023, 02:55:20: total loss for 13000 steps : 2107.225699067116
04/13/2023, 02:58:09: total loss for 14000 steps : 2046.1993318796158
04/13/2023, 03:00:59: total loss for 15000 steps : 1981.5350668430328
04/13/2023, 03:03:44: total loss for 16000 steps : 1924.7748823165894
04/13/2023, 03:06:35: total loss for 17000 steps : 1869.6089977025986
04/13/2023, 03:08:12: ---------- start evaluation after epoch 0 ----------
04/13/2023, 03:18:04: validation hit @ 1 is 0.003943217665615142
04/13/2023, 03:18:04: validation hit @ 5 is 0.01774447949526814
04/13/2023, 03:18:04: validation hit @ 10 is 0.03055993690851735
04/13/2023, 03:18:04: validation ncdg @ 5 is 0.010941937169082747
04/13/2023, 03:18:04: validation ncdg @ 10 is 0.015070253729068511
04/13/2023, 03:18:11: validation hit @ 1 is 0.003680336487907466
04/13/2023, 03:18:11: validation hit @ 5 is 0.014327024185068349
04/13/2023, 03:18:11: validation hit @ 10 is 0.025039432176656152
04/13/2023, 03:18:11: validation ncdg @ 5 is 0.008947814758063107
04/13/2023, 03:18:11: validation ncdg @ 10 is 0.01237947705666298
04/13/2023, 03:27:53: test hit @ 1 is 0.0034174553101997897
04/13/2023, 03:27:53: test hit @ 5 is 0.014195583596214511
04/13/2023, 03:27:53: test hit @ 10 is 0.024579390115667718
04/13/2023, 03:27:53: test ncdg @ 5 is 0.008870811600171107
04/13/2023, 03:27:53: test ncdg @ 10 is 0.012198050557993423
04/13/2023, 03:27:53: recall increases from 0 ----> 0.03055993690851735 at epoch 0
04/13/2023, 03:27:53: save current best model to best_model/yelp/pretrain_t5_small_yelp_CF_200_20_norep.pt
04/13/2023, 03:28:07: test hit @ 1 is 0.0034831756046267088
04/13/2023, 03:28:07: test hit @ 5 is 0.013406940063091483
04/13/2023, 03:28:07: test hit @ 10 is 0.023527865404837013
04/13/2023, 03:28:07: test ncdg @ 5 is 0.008363140542545945
04/13/2023, 03:28:07: test ncdg @ 10 is 0.011602870460319334
04/13/2023, 03:28:07: recall increases from 0 ----> 0.025039432176656152 at epoch 0
04/13/2023, 03:28:15: ---------- training epoch 1 ----------
04/13/2023, 03:29:25: total loss for 18000 steps : 1819.2418756484985
04/13/2023, 03:32:13: total loss for 19000 steps : 1766.7058213949203
04/13/2023, 03:35:02: total loss for 20000 steps : 1718.4485901594162
04/13/2023, 03:37:50: total loss for 21000 steps : 1680.9674334526062
04/13/2023, 03:40:39: total loss for 22000 steps : 1650.2237858772278
04/13/2023, 03:43:28: total loss for 23000 steps : 1611.0678279399872
04/13/2023, 03:46:18: total loss for 24000 steps : 1583.7592653036118
04/13/2023, 03:49:06: total loss for 25000 steps : 1556.332114815712
04/13/2023, 03:51:54: total loss for 26000 steps : 1532.887022972107
04/13/2023, 03:54:40: total loss for 27000 steps : 1510.3494238853455
04/13/2023, 03:57:23: total loss for 28000 steps : 1492.4842896461487
04/13/2023, 04:00:07: total loss for 29000 steps : 1470.5551092624664
04/13/2023, 04:02:54: total loss for 30000 steps : 1455.912293791771
04/13/2023, 04:05:41: total loss for 31000 steps : 1439.2531090974808
04/13/2023, 04:08:29: total loss for 32000 steps : 1429.3828914165497
04/13/2023, 04:11:17: total loss for 33000 steps : 1413.5498478412628
04/13/2023, 04:14:06: total loss for 34000 steps : 1406.031835436821
04/13/2023, 04:16:56: total loss for 35000 steps : 1391.4355325698853
04/13/2023, 04:17:24: ---------- start evaluation after epoch 1 ----------
04/13/2023, 04:27:21: validation hit @ 1 is 0.00545478443743428
04/13/2023, 04:27:21: validation hit @ 5 is 0.019781808622502627
04/13/2023, 04:27:21: validation hit @ 10 is 0.033057308096740276
04/13/2023, 04:27:21: validation ncdg @ 5 is 0.012553322426964242
04/13/2023, 04:27:21: validation ncdg @ 10 is 0.01679310731468322
04/13/2023, 04:27:21: validation hit @ 1 is 0.004994742376445847
04/13/2023, 04:27:21: validation hit @ 5 is 0.018861724500525763
04/13/2023, 04:27:21: validation hit @ 10 is 0.033648790746582544
04/13/2023, 04:27:21: validation ncdg @ 5 is 0.011907567074447655
04/13/2023, 04:27:21: validation ncdg @ 10 is 0.016632512948053048
04/13/2023, 04:37:17: test hit @ 1 is 0.0042718191377497374
04/13/2023, 04:37:17: test hit @ 5 is 0.01984752891692955
04/13/2023, 04:37:17: test hit @ 10 is 0.03318874868559411
04/13/2023, 04:37:17: test ncdg @ 5 is 0.011985235169216304
04/13/2023, 04:37:17: test ncdg @ 10 is 0.016252637863973088
04/13/2023, 04:37:17: recall increases from 0.03055993690851735 ----> 0.033057308096740276 at epoch 1
04/13/2023, 04:37:17: save current best model to best_model/yelp/pretrain_t5_small_yelp_CF_200_20_norep.pt
04/13/2023, 04:37:18: test hit @ 1 is 0.005257623554153523
04/13/2023, 04:37:18: test hit @ 5 is 0.020570452155625658
04/13/2023, 04:37:18: test hit @ 10 is 0.03213722397476341
04/13/2023, 04:37:18: test ncdg @ 5 is 0.012725637488127562
04/13/2023, 04:37:18: test ncdg @ 10 is 0.016451426809151178
04/13/2023, 04:37:18: recall increases from 0.025039432176656152 ----> 0.033648790746582544 at epoch 1
04/13/2023, 04:37:22: ---------- training epoch 2 ----------
04/13/2023, 04:39:41: total loss for 36000 steps : 1382.8254879713058
04/13/2023, 04:42:29: total loss for 37000 steps : 1371.938469529152
04/13/2023, 04:45:16: total loss for 38000 steps : 1366.695054769516
04/13/2023, 04:48:05: total loss for 39000 steps : 1359.4695361852646
04/13/2023, 04:50:52: total loss for 40000 steps : 1351.975276708603
04/13/2023, 04:53:40: total loss for 41000 steps : 1347.71590924263
04/13/2023, 04:56:30: total loss for 42000 steps : 1340.0994250774384
04/13/2023, 04:59:19: total loss for 43000 steps : 1334.0025165081024
04/13/2023, 05:02:07: total loss for 44000 steps : 1328.722572684288
04/13/2023, 05:04:57: total loss for 45000 steps : 1322.9929571151733
04/13/2023, 05:07:41: total loss for 46000 steps : 1318.1292867660522
04/13/2023, 05:10:26: total loss for 47000 steps : 1318.600722193718
04/13/2023, 05:13:13: total loss for 48000 steps : 1312.4977222681046
04/13/2023, 05:15:59: total loss for 49000 steps : 1306.0295474529266
04/13/2023, 05:18:45: total loss for 50000 steps : 1300.965679526329
04/13/2023, 05:21:31: total loss for 51000 steps : 1296.5095710754395
04/13/2023, 05:24:16: total loss for 52000 steps : 1295.240578532219
04/13/2023, 05:26:20: ---------- start evaluation after epoch 2 ----------
04/13/2023, 05:36:18: validation hit @ 1 is 0.005126182965299685
04/13/2023, 05:36:18: validation hit @ 5 is 0.01965036803364879
04/13/2023, 05:36:18: validation hit @ 10 is 0.035751840168243953
04/13/2023, 05:36:18: validation ncdg @ 5 is 0.012349186797272099
04/13/2023, 05:36:18: validation ncdg @ 10 is 0.017477208383929254
04/13/2023, 05:36:20: validation hit @ 1 is 0.0057833859095688745
04/13/2023, 05:36:20: validation hit @ 5 is 0.022476340694006308
04/13/2023, 05:36:20: validation hit @ 10 is 0.03976077812828602
04/13/2023, 05:36:20: validation ncdg @ 5 is 0.01419196722726588
04/13/2023, 05:36:20: validation ncdg @ 10 is 0.019711692921773848
04/13/2023, 05:46:15: test hit @ 1 is 0.00473186119873817
04/13/2023, 05:46:15: test hit @ 5 is 0.019453207150368034
04/13/2023, 05:46:15: test hit @ 10 is 0.03378023133543638
04/13/2023, 05:46:15: test ncdg @ 5 is 0.012021716695889697
04/13/2023, 05:46:15: test ncdg @ 10 is 0.016640457500659497
04/13/2023, 05:46:15: recall increases from 0.033648790746582544 ----> 0.035751840168243953 at epoch 2
04/13/2023, 05:46:17: test hit @ 1 is 0.005257623554153523
04/13/2023, 05:46:17: test hit @ 5 is 0.02089905362776025
04/13/2023, 05:46:17: test hit @ 10 is 0.036540483701366984
04/13/2023, 05:46:17: test ncdg @ 5 is 0.012916766794205236
04/13/2023, 05:46:17: test ncdg @ 10 is 0.01793541267247518
04/13/2023, 05:46:17: recall increases from 0.033057308096740276 ----> 0.03976077812828602 at epoch 2
04/13/2023, 05:46:17: save current best model to best_model/yelp/pretrain_t5_small_yelp_CF_200_20_norep.pt
04/13/2023, 05:46:18: ---------- training epoch 3 ----------
04/13/2023, 05:47:01: total loss for 53000 steps : 1295.4215743541718
04/13/2023, 05:49:48: total loss for 54000 steps : 1288.214539051056
04/13/2023, 05:52:37: total loss for 55000 steps : 1286.3735649585724
04/13/2023, 05:55:30: total loss for 56000 steps : 1279.7207642793655
04/13/2023, 05:58:22: total loss for 57000 steps : 1277.0468055009842
04/13/2023, 06:01:12: total loss for 58000 steps : 1272.1904649734497
04/13/2023, 06:04:05: total loss for 59000 steps : 1274.2371754646301
04/13/2023, 06:06:55: total loss for 60000 steps : 1269.5212240219116
04/13/2023, 06:09:46: total loss for 61000 steps : 1269.2578619718552
04/13/2023, 06:12:38: total loss for 62000 steps : 1262.9020065069199
04/13/2023, 06:15:29: total loss for 63000 steps : 1263.690206170082
04/13/2023, 06:18:20: total loss for 64000 steps : 1256.4578437805176
04/13/2023, 06:21:12: total loss for 65000 steps : 1255.3512873649597
04/13/2023, 06:24:05: total loss for 66000 steps : 1256.1308870315552
04/13/2023, 06:26:54: total loss for 67000 steps : 1250.4305473566055
04/13/2023, 06:29:42: total loss for 68000 steps : 1244.0597269535065
04/13/2023, 06:32:30: total loss for 69000 steps : 1241.6087888479233
04/13/2023, 06:35:16: total loss for 70000 steps : 1241.540484905243
04/13/2023, 06:36:10: ---------- start evaluation after epoch 3 ----------
04/13/2023, 06:45:59: validation hit @ 1 is 0.00611198738170347
04/13/2023, 06:45:59: validation hit @ 5 is 0.025630914826498423
04/13/2023, 06:45:59: validation hit @ 10 is 0.04403259726603575
04/13/2023, 06:45:59: validation ncdg @ 5 is 0.01578392611139854
04/13/2023, 06:45:59: validation ncdg @ 10 is 0.021686922994360848
04/13/2023, 06:46:00: validation hit @ 1 is 0.005717665615141956
04/13/2023, 06:46:00: validation hit @ 5 is 0.02425078864353312
04/13/2023, 06:46:00: validation hit @ 10 is 0.041140904311251315
04/13/2023, 06:46:00: validation ncdg @ 5 is 0.014918158915590483
04/13/2023, 06:46:00: validation ncdg @ 10 is 0.020371311305104053
04/13/2023, 06:55:57: test hit @ 1 is 0.007163512092534174
04/13/2023, 06:55:57: test hit @ 5 is 0.022739221871713986
04/13/2023, 06:55:57: test hit @ 10 is 0.04087802313354364
04/13/2023, 06:55:57: test ncdg @ 5 is 0.015026711373164765
04/13/2023, 06:55:57: test ncdg @ 10 is 0.020810574136569417
04/13/2023, 06:55:57: recall increases from 0.03976077812828602 ----> 0.04403259726603575 at epoch 3
04/13/2023, 06:55:57: save current best model to best_model/yelp/pretrain_t5_small_yelp_CF_200_20_norep.pt
04/13/2023, 06:56:00: test hit @ 1 is 0.005717665615141956
04/13/2023, 06:56:00: test hit @ 5 is 0.02326498422712934
04/13/2023, 06:56:00: test hit @ 10 is 0.039563617245005255
04/13/2023, 06:56:00: test ncdg @ 5 is 0.014375858843518198
04/13/2023, 06:56:00: test ncdg @ 10 is 0.01959828360984919
04/13/2023, 06:56:00: recall increases from 0.035751840168243953 ----> 0.041140904311251315 at epoch 3
04/13/2023, 06:56:00: ---------- training epoch 4 ----------
04/13/2023, 06:57:51: total loss for 71000 steps : 1237.8679832220078
04/13/2023, 07:00:37: total loss for 72000 steps : 1235.7803409099579
04/13/2023, 07:03:25: total loss for 73000 steps : 1231.754613518715
04/13/2023, 07:06:12: total loss for 74000 steps : 1228.510273218155
04/13/2023, 07:08:59: total loss for 75000 steps : 1227.579685807228
04/13/2023, 07:11:50: total loss for 76000 steps : 1223.7662464380264
04/13/2023, 07:14:40: total loss for 77000 steps : 1220.8282316923141
04/13/2023, 07:17:28: total loss for 78000 steps : 1220.459440588951
04/13/2023, 07:20:16: total loss for 79000 steps : 1219.8925907611847
04/13/2023, 07:22:59: total loss for 80000 steps : 1215.3479232788086
04/13/2023, 07:25:46: total loss for 81000 steps : 1211.3780233860016
04/13/2023, 07:28:40: total loss for 82000 steps : 1209.6440830230713
04/13/2023, 07:31:33: total loss for 83000 steps : 1203.7122893333435
04/13/2023, 07:34:29: total loss for 84000 steps : 1201.3925604820251
04/13/2023, 07:37:28: total loss for 85000 steps : 1201.527282834053
04/13/2023, 07:40:28: total loss for 86000 steps : 1198.2564101219177
04/13/2023, 07:43:22: total loss for 87000 steps : 1196.1041057109833
04/13/2023, 07:46:00: ---------- start evaluation after epoch 4 ----------
04/13/2023, 07:55:49: validation hit @ 1 is 0.006834910620399579
04/13/2023, 07:55:49: validation hit @ 5 is 0.024579390115667718
04/13/2023, 07:55:49: validation hit @ 10 is 0.04265247108307045
04/13/2023, 07:55:49: validation ncdg @ 5 is 0.01567214942769026
04/13/2023, 07:55:49: validation ncdg @ 10 is 0.021473635756793837
04/13/2023, 07:55:56: validation hit @ 1 is 0.00814931650893796
04/13/2023, 07:55:56: validation hit @ 5 is 0.028391167192429023
04/13/2023, 07:55:56: validation hit @ 10 is 0.047121451104100945
04/13/2023, 07:55:56: validation ncdg @ 5 is 0.018116960931713805
04/13/2023, 07:55:56: validation ncdg @ 10 is 0.02414602424656629
04/13/2023, 08:05:38: test hit @ 1 is 0.007360672975814932
04/13/2023, 08:05:38: test hit @ 5 is 0.024579390115667718
04/13/2023, 08:05:38: test hit @ 10 is 0.040746582544689804
04/13/2023, 08:05:38: test ncdg @ 5 is 0.015921679987976438
04/13/2023, 08:05:38: test ncdg @ 10 is 0.02111599492352114
04/13/2023, 08:05:38: recall increases from 0.041140904311251315 ----> 0.04265247108307045 at epoch 4
04/13/2023, 08:05:47: test hit @ 1 is 0.0069663512092534175
04/13/2023, 08:05:47: test hit @ 5 is 0.02595951629863302
04/13/2023, 08:05:47: test hit @ 10 is 0.04442691903259727
04/13/2023, 08:05:47: test ncdg @ 5 is 0.016396207426587366
04/13/2023, 08:05:47: test ncdg @ 10 is 0.022399614689147876
04/13/2023, 08:05:47: recall increases from 0.04403259726603575 ----> 0.047121451104100945 at epoch 4
04/13/2023, 08:05:47: save current best model to best_model/yelp/pretrain_t5_small_yelp_CF_200_20_norep.pt
04/13/2023, 08:05:48: ---------- training epoch 5 ----------
04/13/2023, 08:06:04: total loss for 88000 steps : 1191.875625371933
04/13/2023, 08:08:58: total loss for 89000 steps : 1188.6365879774094
04/13/2023, 08:11:53: total loss for 90000 steps : 1186.6626459360123
04/13/2023, 08:14:46: total loss for 91000 steps : 1183.1200259923935
04/13/2023, 08:17:40: total loss for 92000 steps : 1181.6590960025787
04/13/2023, 08:20:29: total loss for 93000 steps : 1175.8205329179764
04/13/2023, 08:23:24: total loss for 94000 steps : 1173.0413315296173
04/13/2023, 08:26:17: total loss for 95000 steps : 1171.8762947320938
04/13/2023, 08:29:13: total loss for 96000 steps : 1167.326574921608
04/13/2023, 08:32:07: total loss for 97000 steps : 1169.8819519281387
04/13/2023, 08:35:02: total loss for 98000 steps : 1163.7890496253967
04/13/2023, 08:37:55: total loss for 99000 steps : 1161.150302886963
04/13/2023, 08:40:51: total loss for 100000 steps : 1157.159924030304
04/13/2023, 08:43:43: total loss for 101000 steps : 1154.0519077777863
04/13/2023, 08:46:38: total loss for 102000 steps : 1151.1941771507263
04/13/2023, 08:49:33: total loss for 103000 steps : 1148.0964502096176
04/13/2023, 08:52:26: total loss for 104000 steps : 1142.0380370616913
04/13/2023, 08:55:21: total loss for 105000 steps : 1141.3661352396011
04/13/2023, 08:56:46: ---------- start evaluation after epoch 5 ----------
04/13/2023, 09:06:41: validation hit @ 1 is 0.008412197686645636
04/13/2023, 09:06:41: validation hit @ 5 is 0.02911409043112513
04/13/2023, 09:06:41: validation hit @ 10 is 0.04633280757097792
04/13/2023, 09:06:41: validation ncdg @ 5 is 0.018727413829993014
04/13/2023, 09:06:41: validation ncdg @ 10 is 0.02421557516136258
04/13/2023, 09:06:41: validation hit @ 1 is 0.009069400630914827
04/13/2023, 09:06:41: validation hit @ 5 is 0.028391167192429023
04/13/2023, 09:06:41: validation hit @ 10 is 0.046661409043112514
04/13/2023, 09:06:41: validation ncdg @ 5 is 0.018622506402616135
04/13/2023, 09:06:41: validation ncdg @ 10 is 0.024523797146939176
04/13/2023, 09:16:30: test hit @ 1 is 0.008477917981072555
04/13/2023, 09:16:30: test hit @ 5 is 0.02661671924290221
04/13/2023, 09:16:30: test hit @ 10 is 0.04383543638275499
04/13/2023, 09:16:30: test ncdg @ 5 is 0.017441851457379264
04/13/2023, 09:16:30: test ncdg @ 10 is 0.022986675477952644
04/13/2023, 09:16:32: test hit @ 1 is 0.00814931650893796
04/13/2023, 09:16:32: test hit @ 5 is 0.02595951629863302
04/13/2023, 09:16:32: test hit @ 10 is 0.04219242902208202
04/13/2023, 09:16:32: test ncdg @ 5 is 0.0169630055487807
04/13/2023, 09:16:32: test ncdg @ 10 is 0.0221576084914126
04/13/2023, 09:16:32: recall increases from 0.04265247108307045 ----> 0.04633280757097792 at epoch 5
04/13/2023, 09:16:32: ---------- training epoch 6 ----------
04/13/2023, 09:17:59: total loss for 106000 steps : 1135.520488858223
04/13/2023, 09:20:57: total loss for 107000 steps : 1134.7111064195633
04/13/2023, 09:23:52: total loss for 108000 steps : 1129.781184911728
04/13/2023, 09:26:46: total loss for 109000 steps : 1124.4832761883736
04/13/2023, 09:29:43: total loss for 110000 steps : 1124.5685532093048
04/13/2023, 09:32:40: total loss for 111000 steps : 1120.700610280037
04/13/2023, 09:35:35: total loss for 112000 steps : 1118.2213625907898
04/13/2023, 09:38:30: total loss for 113000 steps : 1115.6179373264313
04/13/2023, 09:41:25: total loss for 114000 steps : 1109.6617830395699
04/13/2023, 09:44:19: total loss for 115000 steps : 1106.0661924481392
04/13/2023, 09:47:12: total loss for 116000 steps : 1102.409270465374
04/13/2023, 09:50:06: total loss for 117000 steps : 1098.6634724140167
04/13/2023, 09:53:02: total loss for 118000 steps : 1093.896324813366
04/13/2023, 09:55:57: total loss for 119000 steps : 1091.3365125060081
04/13/2023, 09:58:49: total loss for 120000 steps : 1088.7700154185295
04/13/2023, 10:01:44: total loss for 121000 steps : 1085.674930214882
04/13/2023, 10:04:35: total loss for 122000 steps : 1082.528874874115
04/13/2023, 10:07:27: total loss for 123000 steps : 1076.7409585118294
04/13/2023, 10:07:41: ---------- start evaluation after epoch 6 ----------
04/13/2023, 10:17:39: validation hit @ 1 is 0.010712407991587802
04/13/2023, 10:17:39: validation hit @ 5 is 0.030494216614090432
04/13/2023, 10:17:39: validation hit @ 10 is 0.04929022082018927
04/13/2023, 10:17:39: validation ncdg @ 5 is 0.020530271015219974
04/13/2023, 10:17:39: validation ncdg @ 10 is 0.02659249223765557
04/13/2023, 10:17:41: validation hit @ 1 is 0.010449526813880125
04/13/2023, 10:17:41: validation hit @ 5 is 0.031019978969505785
04/13/2023, 10:17:41: validation hit @ 10 is 0.04929022082018927
04/13/2023, 10:17:41: validation ncdg @ 5 is 0.020742458407498592
04/13/2023, 10:17:41: validation ncdg @ 10 is 0.0265449383233365
04/13/2023, 10:27:34: test hit @ 1 is 0.008806519453207151
04/13/2023, 10:27:34: test hit @ 5 is 0.027536803364879073
04/13/2023, 10:27:34: test hit @ 10 is 0.045018401682439535
04/13/2023, 10:27:34: test ncdg @ 5 is 0.018086319435621053
04/13/2023, 10:27:34: test ncdg @ 10 is 0.02371771855020142
04/13/2023, 10:27:34: recall increases from 0.04633280757097792 ----> 0.04929022082018927 at epoch 6
04/13/2023, 10:27:34: test hit @ 1 is 0.008609358569926394
04/13/2023, 10:27:34: test hit @ 5 is 0.027536803364879073
04/13/2023, 10:27:34: test hit @ 10 is 0.045084121976866454
04/13/2023, 10:27:34: test ncdg @ 5 is 0.018206938525790844
04/13/2023, 10:27:34: test ncdg @ 10 is 0.023802189618668073
04/13/2023, 10:27:34: recall increases from 0.047121451104100945 ----> 0.04929022082018927 at epoch 6
04/13/2023, 10:27:34: save current best model to best_model/yelp/pretrain_t5_small_yelp_CF_200_20_norep.pt
04/13/2023, 10:27:35: ---------- training epoch 7 ----------
04/13/2023, 10:30:15: total loss for 124000 steps : 1073.3790190815926
04/13/2023, 10:33:05: total loss for 125000 steps : 1069.67175334692
04/13/2023, 10:35:55: total loss for 126000 steps : 1062.9646787047386
04/13/2023, 10:38:48: total loss for 127000 steps : 1059.3393340110779
04/13/2023, 10:41:41: total loss for 128000 steps : 1057.3924864530563
04/13/2023, 10:44:36: total loss for 129000 steps : 1048.7241290807724
04/13/2023, 10:47:32: total loss for 130000 steps : 1047.8178563714027
04/13/2023, 10:50:23: total loss for 131000 steps : 1043.0425869226456
04/13/2023, 10:53:11: total loss for 132000 steps : 1038.027088522911
04/13/2023, 10:56:09: total loss for 133000 steps : 1037.179104566574
04/13/2023, 10:59:07: total loss for 134000 steps : 1032.4215812683105
04/13/2023, 11:02:07: total loss for 135000 steps : 1023.7891398072243
04/13/2023, 11:05:12: total loss for 136000 steps : 1019.8053709864616
04/13/2023, 11:08:13: total loss for 137000 steps : 1020.1304255723953
04/13/2023, 11:11:14: total loss for 138000 steps : 1011.6532666683197
04/13/2023, 11:14:15: total loss for 139000 steps : 1004.8340748548508
04/13/2023, 11:17:14: total loss for 140000 steps : 1003.9736127853394
04/13/2023, 11:19:12: ---------- start evaluation after epoch 7 ----------
04/13/2023, 11:29:18: validation hit @ 1 is 0.01150105152471083
04/13/2023, 11:29:18: validation hit @ 5 is 0.03167718191377497
04/13/2023, 11:29:18: validation hit @ 10 is 0.050538906414300734
04/13/2023, 11:29:18: validation ncdg @ 5 is 0.02176339095208938
04/13/2023, 11:29:18: validation ncdg @ 10 is 0.027846389703220696
04/13/2023, 11:29:21: validation hit @ 1 is 0.011435331230283912
04/13/2023, 11:29:21: validation hit @ 5 is 0.03220294426919033
04/13/2023, 11:29:21: validation hit @ 10 is 0.050538906414300734
04/13/2023, 11:29:21: validation ncdg @ 5 is 0.021924233186963942
04/13/2023, 11:29:21: validation ncdg @ 10 is 0.027790268902143082
04/13/2023, 11:39:19: test hit @ 1 is 0.01084384858044164
04/13/2023, 11:39:19: test hit @ 5 is 0.02990273396424816
04/13/2023, 11:39:19: test hit @ 10 is 0.047121451104100945
04/13/2023, 11:39:19: test ncdg @ 5 is 0.02044473600722378
04/13/2023, 11:39:19: test ncdg @ 10 is 0.0260006332385884
04/13/2023, 11:39:19: recall increases from 0.04929022082018927 ----> 0.050538906414300734 at epoch 7
04/13/2023, 11:39:25: test hit @ 1 is 0.009398002103049422
04/13/2023, 11:39:25: test hit @ 5 is 0.027536803364879073
04/13/2023, 11:39:25: test hit @ 10 is 0.04652996845425868
04/13/2023, 11:39:25: test ncdg @ 5 is 0.018599984854810216
04/13/2023, 11:39:25: test ncdg @ 10 is 0.024741180713837994
04/13/2023, 11:39:25: recall increases from 0.04929022082018927 ----> 0.050538906414300734 at epoch 7
04/13/2023, 11:39:25: save current best model to best_model/yelp/pretrain_t5_small_yelp_CF_200_20_norep.pt
04/13/2023, 11:39:49: ---------- training epoch 8 ----------
04/13/2023, 11:40:49: total loss for 141000 steps : 999.6799340248108
04/13/2023, 11:43:44: total loss for 142000 steps : 991.7586649060249
04/13/2023, 11:46:37: total loss for 143000 steps : 989.4142385721207
04/13/2023, 11:49:27: total loss for 144000 steps : 986.2118707895279
04/13/2023, 11:52:19: total loss for 145000 steps : 978.2762789726257
04/13/2023, 11:55:14: total loss for 146000 steps : 976.1829184889793
04/13/2023, 11:58:15: total loss for 147000 steps : 968.982696056366
04/13/2023, 12:01:09: total loss for 148000 steps : 968.096234023571
04/13/2023, 12:04:05: total loss for 149000 steps : 961.1655295491219
04/13/2023, 12:07:01: total loss for 150000 steps : 954.837373316288
04/13/2023, 12:09:57: total loss for 151000 steps : 953.4095233082771
04/13/2023, 12:12:49: total loss for 152000 steps : 949.7311267852783
04/13/2023, 12:15:44: total loss for 153000 steps : 943.4059435129166
04/13/2023, 12:18:36: total loss for 154000 steps : 939.8520587682724
04/13/2023, 12:21:28: total loss for 155000 steps : 933.2321047782898
04/13/2023, 12:24:21: total loss for 156000 steps : 930.2040394544601
04/13/2023, 12:27:16: total loss for 157000 steps : 921.8340561389923
04/13/2023, 12:30:12: total loss for 158000 steps : 920.433190882206
04/13/2023, 12:30:56: ---------- start evaluation after epoch 8 ----------
04/13/2023, 12:40:55: validation hit @ 1 is 0.01222397476340694
04/13/2023, 12:40:55: validation hit @ 5 is 0.03286014721345951
04/13/2023, 12:40:55: validation hit @ 10 is 0.04975026288117771
04/13/2023, 12:40:55: validation ncdg @ 5 is 0.02276154195032985
04/13/2023, 12:40:55: validation ncdg @ 10 is 0.02816424702163231
04/13/2023, 12:40:58: validation hit @ 1 is 0.011369610935856993
04/13/2023, 12:40:58: validation hit @ 5 is 0.03259726603575184
04/13/2023, 12:40:58: validation hit @ 10 is 0.048435856992639324
04/13/2023, 12:40:58: validation ncdg @ 5 is 0.02190426053111115
04/13/2023, 12:40:59: validation ncdg @ 10 is 0.027003872101164426
04/13/2023, 12:51:02: test hit @ 1 is 0.010646687697160883
04/13/2023, 12:51:02: test hit @ 5 is 0.028128286014721345
04/13/2023, 12:51:02: test hit @ 10 is 0.044558359621451105
04/13/2023, 12:51:02: test ncdg @ 5 is 0.019392828025667115
04/13/2023, 12:51:02: test ncdg @ 10 is 0.02470138802722301
04/13/2023, 12:51:06: test hit @ 1 is 0.009398002103049422
04/13/2023, 12:51:06: test hit @ 5 is 0.027339642481598318
04/13/2023, 12:51:06: test hit @ 10 is 0.0435068349106204
04/13/2023, 12:51:06: test ncdg @ 5 is 0.018435719661842737
04/13/2023, 12:51:06: test ncdg @ 10 is 0.02360830910646716
04/13/2023, 12:51:06: ---------- training epoch 9 ----------
04/13/2023, 12:53:23: total loss for 159000 steps : 908.8854022622108
04/13/2023, 12:56:25: total loss for 160000 steps : 907.3878942131996
04/13/2023, 12:59:28: total loss for 161000 steps : 901.0180450677872
04/13/2023, 13:02:28: total loss for 162000 steps : 896.3653173446655
04/13/2023, 13:05:25: total loss for 163000 steps : 894.1343309283257
04/13/2023, 13:08:31: total loss for 164000 steps : 889.0980739593506
04/13/2023, 13:11:30: total loss for 165000 steps : 880.6137492060661
04/13/2023, 13:14:27: total loss for 166000 steps : 877.3298258781433
04/13/2023, 13:17:22: total loss for 167000 steps : 876.1137841939926
04/13/2023, 13:20:18: total loss for 168000 steps : 868.7790775895119
04/13/2023, 13:23:19: total loss for 169000 steps : 859.3905199766159
04/13/2023, 13:26:20: total loss for 170000 steps : 859.4226121306419
04/13/2023, 13:29:20: total loss for 171000 steps : 852.7631678581238
04/13/2023, 13:32:18: total loss for 172000 steps : 849.4630800485611
04/13/2023, 13:35:16: total loss for 173000 steps : 845.5754583477974
04/13/2023, 13:38:10: total loss for 174000 steps : 839.9314547777176
04/13/2023, 13:41:10: total loss for 175000 steps : 834.6943742632866
04/13/2023, 13:43:40: ---------- start evaluation after epoch 9 ----------
04/13/2023, 13:53:43: validation hit @ 1 is 0.012158254468980022
04/13/2023, 13:53:43: validation hit @ 5 is 0.03220294426919033
04/13/2023, 13:53:43: validation hit @ 10 is 0.048698738170347006
04/13/2023, 13:53:43: validation ncdg @ 5 is 0.02237329932954445
04/13/2023, 13:53:43: validation ncdg @ 10 is 0.0276823105916954
04/13/2023, 13:53:52: validation hit @ 1 is 0.012026813880126183
04/13/2023, 13:53:52: validation hit @ 5 is 0.03253154574132492
04/13/2023, 13:53:52: validation hit @ 10 is 0.04863301787592009
04/13/2023, 13:53:52: validation ncdg @ 5 is 0.022536858840330083
04/13/2023, 13:53:52: validation ncdg @ 10 is 0.027714394812301167
04/13/2023, 14:03:44: test hit @ 1 is 0.010580967402733964
04/13/2023, 14:03:44: test hit @ 5 is 0.027339642481598318
04/13/2023, 14:03:44: test hit @ 10 is 0.04317823343848581
04/13/2023, 14:03:44: test ncdg @ 5 is 0.0190002786045286
04/13/2023, 14:03:44: test ncdg @ 10 is 0.024048981122288572
04/13/2023, 14:04:03: test hit @ 1 is 0.00952944269190326
04/13/2023, 14:04:03: test hit @ 5 is 0.027536803364879073
04/13/2023, 14:04:03: test hit @ 10 is 0.042455310199789695
04/13/2023, 14:04:03: test ncdg @ 5 is 0.018725656676764152
04/13/2023, 14:04:03: test ncdg @ 10 is 0.023497852290195388
04/13/2023, 14:04:03: ---------- training epoch 10 ----------
04/13/2023, 14:04:34: total loss for 176000 steps : 831.0145999789238
04/13/2023, 14:07:33: total loss for 177000 steps : 821.8069803714752
04/13/2023, 14:10:33: total loss for 178000 steps : 819.0822941064835
04/13/2023, 14:13:30: total loss for 179000 steps : 812.5463054776192
04/13/2023, 14:16:33: total loss for 180000 steps : 807.3000563383102
04/13/2023, 14:19:36: total loss for 181000 steps : 804.9674028158188
04/13/2023, 14:22:38: total loss for 182000 steps : 801.5163587331772
04/13/2023, 14:25:35: total loss for 183000 steps : 792.8608902692795
04/13/2023, 14:28:23: total loss for 184000 steps : 789.7081861495972
04/13/2023, 14:31:18: total loss for 185000 steps : 780.9263577461243
04/13/2023, 14:34:19: total loss for 186000 steps : 779.793653011322
04/13/2023, 14:37:18: total loss for 187000 steps : 772.7051764726639
04/13/2023, 14:40:19: total loss for 188000 steps : 767.7196889519691
04/13/2023, 14:43:19: total loss for 189000 steps : 764.9178025126457
04/13/2023, 14:46:19: total loss for 190000 steps : 760.456180870533
04/13/2023, 14:49:19: total loss for 191000 steps : 754.4617314338684
04/13/2023, 14:52:19: total loss for 192000 steps : 750.9555326700211
04/13/2023, 14:55:18: total loss for 193000 steps : 743.9447070360184
04/13/2023, 14:56:31: ---------- start evaluation after epoch 10 ----------
04/13/2023, 15:06:33: validation hit @ 1 is 0.012946898002103049
04/13/2023, 15:06:33: validation hit @ 5 is 0.032465825446898
04/13/2023, 15:06:33: validation hit @ 10 is 0.04929022082018927
04/13/2023, 15:06:33: validation ncdg @ 5 is 0.02304451448303327
04/13/2023, 15:06:33: validation ncdg @ 10 is 0.028487323696688157
04/13/2023, 15:06:39: validation hit @ 1 is 0.01288117770767613
04/13/2023, 15:06:39: validation hit @ 5 is 0.032794426919032595
04/13/2023, 15:06:39: validation hit @ 10 is 0.049224500525762355
04/13/2023, 15:06:39: validation ncdg @ 5 is 0.022708342519419705
04/13/2023, 15:06:39: validation ncdg @ 10 is 0.027956262057345055
04/13/2023, 15:16:35: test hit @ 1 is 0.011106729758149317
04/13/2023, 15:16:35: test hit @ 5 is 0.028062565720294426
04/13/2023, 15:16:35: test hit @ 10 is 0.04219242902208202
04/13/2023, 15:16:35: test ncdg @ 5 is 0.01960472172632183
04/13/2023, 15:16:35: test ncdg @ 10 is 0.024124773441354743
04/13/2023, 15:16:49: test hit @ 1 is 0.010712407991587802
04/13/2023, 15:16:49: test hit @ 5 is 0.026879600420609884
04/13/2023, 15:16:49: test hit @ 10 is 0.03995793901156677
04/13/2023, 15:16:49: test ncdg @ 5 is 0.018937214675265945
04/13/2023, 15:16:49: test ncdg @ 10 is 0.023147985354022852
04/13/2023, 15:16:49: ---------- training epoch 11 ----------
04/13/2023, 15:18:36: total loss for 194000 steps : 738.9149571061134
04/13/2023, 15:21:34: total loss for 195000 steps : 735.2626531124115
04/13/2023, 15:24:38: total loss for 196000 steps : 727.4909428358078
04/13/2023, 15:27:39: total loss for 197000 steps : 725.2157131433487
04/13/2023, 15:30:33: total loss for 198000 steps : 720.8447788953781
04/13/2023, 15:33:36: total loss for 199000 steps : 716.2550984025002
04/13/2023, 15:36:37: total loss for 200000 steps : 709.8721732497215
04/13/2023, 15:39:36: total loss for 201000 steps : 707.4621296525002
04/13/2023, 15:42:34: total loss for 202000 steps : 701.425446331501
04/13/2023, 15:45:31: total loss for 203000 steps : 697.9226214885712
04/13/2023, 15:48:26: total loss for 204000 steps : 694.03150588274
04/13/2023, 15:51:23: total loss for 205000 steps : 686.7303829193115
04/13/2023, 15:54:19: total loss for 206000 steps : 686.487652182579
04/13/2023, 15:57:15: total loss for 207000 steps : 681.2997952699661
04/13/2023, 16:00:09: total loss for 208000 steps : 674.3816541433334
04/13/2023, 16:03:03: total loss for 209000 steps : 674.0883164405823
04/13/2023, 16:06:01: total loss for 210000 steps : 670.2368224859238
04/13/2023, 16:09:00: ---------- start evaluation after epoch 11 ----------
04/13/2023, 16:19:03: validation hit @ 1 is 0.013406940063091483
04/13/2023, 16:19:03: validation hit @ 5 is 0.03345162986330179
04/13/2023, 16:19:03: validation hit @ 10 is 0.04896161934805468
04/13/2023, 16:19:03: validation ncdg @ 5 is 0.02346383103011561
04/13/2023, 16:19:03: validation ncdg @ 10 is 0.028434647455410873
04/13/2023, 16:19:10: validation hit @ 1 is 0.013275499474237645
04/13/2023, 16:19:10: validation hit @ 5 is 0.03299158780231336
04/13/2023, 16:19:10: validation hit @ 10 is 0.047450052576235545
04/13/2023, 16:19:10: validation ncdg @ 5 is 0.023243619048547545
04/13/2023, 16:19:10: validation ncdg @ 10 is 0.027894678393250487
04/13/2023, 16:29:04: test hit @ 1 is 0.010580967402733964
04/13/2023, 16:29:04: test hit @ 5 is 0.02635383806519453
04/13/2023, 16:29:04: test hit @ 10 is 0.04087802313354364
04/13/2023, 16:29:04: test ncdg @ 5 is 0.0187318139609656
04/13/2023, 16:29:04: test ncdg @ 10 is 0.02336987487890967
04/13/2023, 16:29:19: test hit @ 1 is 0.010646687697160883
04/13/2023, 16:29:19: test hit @ 5 is 0.025368033648790745
04/13/2023, 16:29:19: test hit @ 10 is 0.03976077812828602
04/13/2023, 16:29:19: test ncdg @ 5 is 0.01801869615989551
04/13/2023, 16:29:19: test ncdg @ 10 is 0.02264077583055707
04/13/2023, 16:29:19: ---------- training epoch 12 ----------
04/13/2023, 16:29:20: total loss for 211000 steps : 664.0520473122597
04/13/2023, 16:32:23: total loss for 212000 steps : 655.3847114443779
04/13/2023, 16:35:27: total loss for 213000 steps : 651.4727010130882
