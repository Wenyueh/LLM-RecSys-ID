04/13/2023, 02:49:46: Namespace(seed=2022, data_dir='data/', logging_dir='log/yelp/pretrain_t5_small_yelp_content_based_norep.log', model_dir='model/yelp/pretrain_t5_small_yelp_content_based_norep.pt', task='yelp', max_history=20, sequential_num=10, negative_sample=2, yes_no_sample=5, direct_item_proportion=2, train_sequential_item_batch=64, train_sequential_yesno_batch=32, train_direct_yesno_batch=48, train_direct_candidate_batch=12, train_direct_straightforward_batch=48, meta_title_batch=128, meta_description_batch=12, meta_category_batch=128, meta_epochs=10, meta_lr=0.0001, review_user_batch=16, review_item_batch=16, review_epochs=2, review_lr=0.0001, model_type='t5-small', epochs=20, lr=0.001, clip=1.0, logging_step=1000, warmup_prop=0.05, gradient_accumulation_steps=1, weight_decay=0.01, adam_eps=1e-06, dropout=0.1, alpha=2, multiGPU=True, distributed=True, gpu='6,7', local_rank=0, evaluation_method='sequential_item', evaluation_template_id=0, number_of_items=20034, item_representation='content_based', cluster_number=55, cluster_size=100, optimal_width_in_CF=False, category_no_repetition=False, last_token_no_repetition=False, hybrid_order='CF_first', data_order='random', remapped_data_order='original', resolution=2, max_random_number=30000, min_random_number=1000, overlap=0, base=10, random_initialization_embedding=False, whole_word_embedding='shijie', no_pretrain=False, use_meta_data=False, use_review_data=False, remove_last_item=False, remove_first_item=False, eval_only=False, check_data=False)
04/13/2023, 02:50:05: Process Launching at GPU 0
04/13/2023, 02:50:05: Process Launching at GPU 1
04/13/2023, 02:50:06: Building train loader at GPU 0
04/13/2023, 02:50:06: loading data ...
04/13/2023, 02:50:06: Building train loader at GPU 1
04/13/2023, 02:50:06: *** use content_based representation, extend vocab ***
04/13/2023, 02:50:09: finished loading data
04/13/2023, 02:50:09: length of training data is 17583
04/13/2023, 02:50:09: loading model ...
04/13/2023, 02:50:09: using only sequential data, and all possible sequences are here
04/13/2023, 02:50:09: use pretrained T5
04/13/2023, 02:50:15: Batch per epoch: 17583
04/13/2023, 02:50:15: Total steps: 351660
04/13/2023, 02:50:15: Warmup proportion:
04/13/2023, 02:50:15: Warm up steps: 17583
04/13/2023, 02:50:17: model dataparallel set
04/13/2023, 02:50:17: start training
04/13/2023, 02:50:17: ---------- training epoch 0 ----------
04/13/2023, 02:53:34: total loss for 1000 steps : 6895.967920780182
04/13/2023, 02:56:50: total loss for 2000 steps : 4961.284338474274
04/13/2023, 03:00:07: total loss for 3000 steps : 4163.986925363541
04/13/2023, 03:03:21: total loss for 4000 steps : 3335.6160497665405
04/13/2023, 03:06:38: total loss for 5000 steps : 2830.563806295395
04/13/2023, 03:09:50: total loss for 6000 steps : 2603.975013256073
04/13/2023, 03:13:04: total loss for 7000 steps : 2464.5356295108795
04/13/2023, 03:16:17: total loss for 8000 steps : 2360.351505756378
04/13/2023, 03:19:31: total loss for 9000 steps : 2267.8334012031555
04/13/2023, 03:22:45: total loss for 10000 steps : 2177.6493178606033
04/13/2023, 03:25:59: total loss for 11000 steps : 2097.040666103363
04/13/2023, 03:29:13: total loss for 12000 steps : 2014.902555346489
04/13/2023, 03:32:27: total loss for 13000 steps : 1937.5640258789062
04/13/2023, 03:35:44: total loss for 14000 steps : 1861.4754894971848
04/13/2023, 03:38:59: total loss for 15000 steps : 1793.167576789856
04/13/2023, 03:42:14: total loss for 16000 steps : 1733.380648136139
04/13/2023, 03:45:30: total loss for 17000 steps : 1673.7672567367554
04/13/2023, 03:47:24: ---------- start evaluation after epoch 0 ----------
04/13/2023, 03:57:14: validation hit @ 1 is 0.0003286014721345952
04/13/2023, 03:57:14: validation hit @ 5 is 0.0003943217665615142
04/13/2023, 03:57:14: validation hit @ 10 is 0.0007229232386961093
04/13/2023, 03:57:14: validation ncdg @ 5 is 0.00037006636130201484
04/13/2023, 03:57:14: validation ncdg @ 10 is 0.00047701980221147235
04/13/2023, 03:57:24: validation hit @ 1 is 0.0002628811777076761
04/13/2023, 03:57:24: validation hit @ 5 is 0.0005914826498422713
04/13/2023, 03:57:24: validation hit @ 10 is 0.0007886435331230284
04/13/2023, 03:57:24: validation ncdg @ 5 is 0.00046160088159081435
04/13/2023, 03:57:24: validation ncdg @ 10 is 0.0005222888518402361
04/13/2023, 04:07:06: test hit @ 1 is 6.572029442691903e-05
04/13/2023, 04:07:06: test hit @ 5 is 0.0003943217665615142
04/13/2023, 04:07:06: test hit @ 10 is 0.0006572029442691904
04/13/2023, 04:07:06: test ncdg @ 5 is 0.0002278024237437823
04/13/2023, 04:07:06: test ncdg @ 10 is 0.0003128490998442668
04/13/2023, 04:07:06: recall increases from 0 ----> 0.0007229232386961093 at epoch 0
04/13/2023, 04:07:27: test hit @ 1 is 0.00013144058885383806
04/13/2023, 04:07:27: test hit @ 5 is 0.0003943217665615142
04/13/2023, 04:07:27: test hit @ 10 is 0.00046004206098843324
04/13/2023, 04:07:27: test ncdg @ 5 is 0.0002623740056334282
04/13/2023, 04:07:27: test ncdg @ 10 is 0.00028578404684715205
04/13/2023, 04:07:27: recall increases from 0 ----> 0.0007886435331230284 at epoch 0
04/13/2023, 04:07:27: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_norep.pt
04/13/2023, 04:07:27: ---------- training epoch 1 ----------
04/13/2023, 04:08:51: total loss for 18000 steps : 1623.2991193532944
04/13/2023, 04:12:09: total loss for 19000 steps : 1573.998782157898
04/13/2023, 04:15:28: total loss for 20000 steps : 1534.8214803934097
04/13/2023, 04:18:45: total loss for 21000 steps : 1498.5823179483414
04/13/2023, 04:22:01: total loss for 22000 steps : 1462.6850706338882
04/13/2023, 04:25:17: total loss for 23000 steps : 1433.6647270917892
04/13/2023, 04:28:31: total loss for 24000 steps : 1410.165738105774
04/13/2023, 04:31:46: total loss for 25000 steps : 1391.668818473816
04/13/2023, 04:35:01: total loss for 26000 steps : 1370.0413995981216
04/13/2023, 04:38:17: total loss for 27000 steps : 1345.3948512077332
04/13/2023, 04:41:36: total loss for 28000 steps : 1331.6953018903732
04/13/2023, 04:44:53: total loss for 29000 steps : 1312.2974623441696
04/13/2023, 04:48:11: total loss for 30000 steps : 1293.9995821714401
04/13/2023, 04:51:26: total loss for 31000 steps : 1275.9577244520187
04/13/2023, 04:54:45: total loss for 32000 steps : 1264.9760612249374
04/13/2023, 04:58:04: total loss for 33000 steps : 1243.7328270673752
04/13/2023, 05:01:23: total loss for 34000 steps : 1229.0209248065948
04/13/2023, 05:04:42: total loss for 35000 steps : 1218.1777025461197
04/13/2023, 05:05:15: ---------- start evaluation after epoch 1 ----------
04/13/2023, 05:15:10: validation hit @ 1 is 0.0003286014721345952
04/13/2023, 05:15:10: validation hit @ 5 is 0.002300210304942166
04/13/2023, 05:15:10: validation hit @ 10 is 0.004534700315457414
04/13/2023, 05:15:10: validation ncdg @ 5 is 0.0012970810505660226
04/13/2023, 05:15:10: validation ncdg @ 10 is 0.002011283196039039
04/13/2023, 05:15:16: validation hit @ 1 is 6.572029442691903e-05
04/13/2023, 05:15:16: validation hit @ 5 is 0.0011172450052576235
04/13/2023, 05:15:16: validation hit @ 10 is 0.0031545741324921135
04/13/2023, 05:15:16: validation ncdg @ 5 is 0.0005355357281308772
04/13/2023, 05:15:16: validation ncdg @ 10 is 0.0011905722341640204
04/13/2023, 05:25:04: test hit @ 1 is 0.0001971608832807571
04/13/2023, 05:25:04: test hit @ 5 is 0.001971608832807571
04/13/2023, 05:25:04: test hit @ 10 is 0.0034174553101997897
04/13/2023, 05:25:04: test ncdg @ 5 is 0.0010704473019540748
04/13/2023, 05:25:04: test ncdg @ 10 is 0.0015218585079116089
04/13/2023, 05:25:04: recall increases from 0.0007229232386961093 ----> 0.004534700315457414 at epoch 1
04/13/2023, 05:25:18: test hit @ 1 is 0.00013144058885383806
04/13/2023, 05:25:18: test hit @ 5 is 0.0005257623554153522
04/13/2023, 05:25:18: test hit @ 10 is 0.0017087276550998948
04/13/2023, 05:25:18: test ncdg @ 5 is 0.00029718135764001123
04/13/2023, 05:25:18: test ncdg @ 10 is 0.0006739334049345861
04/13/2023, 05:25:18: recall increases from 0.0007886435331230284 ----> 0.0031545741324921135 at epoch 1
04/13/2023, 05:25:18: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_norep.pt
04/13/2023, 05:25:19: ---------- training epoch 2 ----------
04/13/2023, 05:28:04: total loss for 36000 steps : 1207.7562106847763
04/13/2023, 05:31:20: total loss for 37000 steps : 1194.721207022667
04/13/2023, 05:34:36: total loss for 38000 steps : 1184.7375477552414
04/13/2023, 05:37:46: total loss for 39000 steps : 1178.7416642904282
04/13/2023, 05:41:02: total loss for 40000 steps : 1169.1948515176773
04/13/2023, 05:44:21: total loss for 41000 steps : 1164.564463019371
04/13/2023, 05:47:42: total loss for 42000 steps : 1156.1515901088715
04/13/2023, 05:51:06: total loss for 43000 steps : 1149.597787618637
04/13/2023, 05:54:31: total loss for 44000 steps : 1141.7957684993744
04/13/2023, 05:57:53: total loss for 45000 steps : 1133.8517611026764
04/13/2023, 06:01:18: total loss for 46000 steps : 1131.02896130085
04/13/2023, 06:04:44: total loss for 47000 steps : 1123.8022340536118
04/13/2023, 06:08:08: total loss for 48000 steps : 1118.3037281036377
04/13/2023, 06:11:30: total loss for 49000 steps : 1113.8097722530365
04/13/2023, 06:14:54: total loss for 50000 steps : 1108.692043185234
04/13/2023, 06:18:16: total loss for 51000 steps : 1101.6725848317146
04/13/2023, 06:21:39: total loss for 52000 steps : 1100.5239468812943
04/13/2023, 06:24:11: ---------- start evaluation after epoch 2 ----------
04/13/2023, 06:34:08: validation hit @ 1 is 0.0005257623554153522
04/13/2023, 06:34:08: validation hit @ 5 is 0.002365930599369085
04/13/2023, 06:34:08: validation hit @ 10 is 0.005257623554153523
04/13/2023, 06:34:08: validation ncdg @ 5 is 0.0014776939973667168
04/13/2023, 06:34:08: validation ncdg @ 10 is 0.0024033554194259534
04/13/2023, 06:34:20: validation hit @ 1 is 0.0009200841219768665
04/13/2023, 06:34:20: validation hit @ 5 is 0.0034174553101997897
04/13/2023, 06:34:20: validation hit @ 10 is 0.006243427970557308
04/13/2023, 06:34:20: validation ncdg @ 5 is 0.0021440088112938444
04/13/2023, 06:34:20: validation ncdg @ 10 is 0.0030687346816959333
04/13/2023, 06:43:56: test hit @ 1 is 0.0007229232386961093
04/13/2023, 06:43:56: test hit @ 5 is 0.0029574132492113563
04/13/2023, 06:43:56: test hit @ 10 is 0.006177707676130389
04/13/2023, 06:43:56: test ncdg @ 5 is 0.0018377155396256247
04/13/2023, 06:43:56: test ncdg @ 10 is 0.0028641888548820004
04/13/2023, 06:43:56: recall increases from 0.004534700315457414 ----> 0.005257623554153523 at epoch 2
04/13/2023, 06:44:16: test hit @ 1 is 0.0005914826498422713
04/13/2023, 06:44:16: test hit @ 5 is 0.0033517350157728706
04/13/2023, 06:44:16: test hit @ 10 is 0.006177707676130389
04/13/2023, 06:44:16: test ncdg @ 5 is 0.0018937335475366864
04/13/2023, 06:44:16: test ncdg @ 10 is 0.0027993039273678795
04/13/2023, 06:44:16: recall increases from 0.0031545741324921135 ----> 0.006243427970557308 at epoch 2
04/13/2023, 06:44:16: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_norep.pt
04/13/2023, 06:44:17: ---------- training epoch 3 ----------
04/13/2023, 06:45:07: total loss for 53000 steps : 1097.1197482347488
04/13/2023, 06:48:27: total loss for 54000 steps : 1091.083490908146
04/13/2023, 06:51:45: total loss for 55000 steps : 1085.9017850160599
04/13/2023, 06:55:07: total loss for 56000 steps : 1081.4289394021034
04/13/2023, 06:58:28: total loss for 57000 steps : 1077.816953778267
04/13/2023, 07:01:51: total loss for 58000 steps : 1074.0036208629608
04/13/2023, 07:05:12: total loss for 59000 steps : 1071.2803146839142
04/13/2023, 07:08:34: total loss for 60000 steps : 1065.9754232764244
04/13/2023, 07:11:57: total loss for 61000 steps : 1064.033822953701
04/13/2023, 07:15:22: total loss for 62000 steps : 1060.7110949754715
04/13/2023, 07:18:51: total loss for 63000 steps : 1059.61867749691
04/13/2023, 07:22:12: total loss for 64000 steps : 1055.3066253066063
04/13/2023, 07:25:32: total loss for 65000 steps : 1049.0782113671303
04/13/2023, 07:29:00: total loss for 66000 steps : 1044.2280318140984
04/13/2023, 07:32:27: total loss for 67000 steps : 1042.7736200094223
04/13/2023, 07:35:55: total loss for 68000 steps : 1038.8828619122505
04/13/2023, 07:39:24: total loss for 69000 steps : 1036.9407340288162
04/13/2023, 07:42:49: total loss for 70000 steps : 1030.185639679432
04/13/2023, 07:43:58: ---------- start evaluation after epoch 3 ----------
04/13/2023, 07:53:40: validation hit @ 1 is 0.0008543638275499474
04/13/2023, 07:53:40: validation hit @ 5 is 0.00407465825446898
04/13/2023, 07:53:40: validation hit @ 10 is 0.008609358569926394
04/13/2023, 07:53:40: validation ncdg @ 5 is 0.0024518964910345484
04/13/2023, 07:53:40: validation ncdg @ 10 is 0.0039001435715204356
04/13/2023, 07:54:08: validation hit @ 1 is 0.002365930599369085
04/13/2023, 07:54:08: validation hit @ 5 is 0.006769190325972661
04/13/2023, 07:54:08: validation hit @ 10 is 0.011369610935856993
04/13/2023, 07:54:08: validation ncdg @ 5 is 0.004556352074854263
04/13/2023, 07:54:08: validation ncdg @ 10 is 0.006031456637632865
04/13/2023, 08:03:24: test hit @ 1 is 0.0015772870662460567
04/13/2023, 08:03:24: test hit @ 5 is 0.0048633017875920085
04/13/2023, 08:03:24: test hit @ 10 is 0.00887223974763407
04/13/2023, 08:03:24: test ncdg @ 5 is 0.003171668217965325
04/13/2023, 08:03:24: test ncdg @ 10 is 0.004445732199613126
04/13/2023, 08:03:24: recall increases from 0.005257623554153523 ----> 0.008609358569926394 at epoch 3
04/13/2023, 08:04:10: test hit @ 1 is 0.001774447949526814
04/13/2023, 08:04:10: test hit @ 5 is 0.005717665615141956
04/13/2023, 08:04:10: test hit @ 10 is 0.01012092534174553
04/13/2023, 08:04:10: test ncdg @ 5 is 0.0038275872217787828
04/13/2023, 08:04:10: test ncdg @ 10 is 0.005236832625130798
04/13/2023, 08:04:10: recall increases from 0.006243427970557308 ----> 0.011369610935856993 at epoch 3
04/13/2023, 08:04:10: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_norep.pt
04/13/2023, 08:04:11: ---------- training epoch 4 ----------
04/13/2023, 08:06:25: total loss for 71000 steps : 1029.8848596811295
04/13/2023, 08:09:48: total loss for 72000 steps : 1024.204195201397
04/13/2023, 08:13:09: total loss for 73000 steps : 1019.7215078473091
04/13/2023, 08:16:34: total loss for 74000 steps : 1018.672304213047
04/13/2023, 08:19:53: total loss for 75000 steps : 1013.3991938829422
04/13/2023, 08:23:15: total loss for 76000 steps : 1011.6193381547928
04/13/2023, 08:26:39: total loss for 77000 steps : 1007.7656652331352
04/13/2023, 08:30:04: total loss for 78000 steps : 1004.5095655918121
04/13/2023, 08:33:28: total loss for 79000 steps : 1003.733911216259
04/13/2023, 08:36:50: total loss for 80000 steps : 998.6162975430489
04/13/2023, 08:40:14: total loss for 81000 steps : 996.2173363566399
04/13/2023, 08:43:36: total loss for 82000 steps : 991.9206409454346
04/13/2023, 08:47:00: total loss for 83000 steps : 989.4550287723541
04/13/2023, 08:50:22: total loss for 84000 steps : 984.1436587572098
04/13/2023, 08:53:44: total loss for 85000 steps : 982.8846636414528
04/13/2023, 08:57:07: total loss for 86000 steps : 979.3460990190506
04/13/2023, 09:00:27: total loss for 87000 steps : 976.1490279436111
04/13/2023, 09:03:30: ---------- start evaluation after epoch 4 ----------
04/13/2023, 09:13:15: validation hit @ 1 is 0.002300210304942166
04/13/2023, 09:13:15: validation hit @ 5 is 0.006834910620399579
04/13/2023, 09:13:15: validation hit @ 10 is 0.011106729758149317
04/13/2023, 09:13:15: validation ncdg @ 5 is 0.004587807776818949
04/13/2023, 09:13:15: validation ncdg @ 10 is 0.0059538697819172225
04/13/2023, 09:13:29: validation hit @ 1 is 0.002300210304942166
04/13/2023, 09:13:29: validation hit @ 5 is 0.006177707676130389
04/13/2023, 09:13:29: validation hit @ 10 is 0.01150105152471083
04/13/2023, 09:13:29: validation ncdg @ 5 is 0.004283697524431061
04/13/2023, 09:13:29: validation ncdg @ 10 is 0.0059658018219755
04/13/2023, 09:23:07: test hit @ 1 is 0.002300210304942166
04/13/2023, 09:23:07: test hit @ 5 is 0.005914826498422713
04/13/2023, 09:23:07: test hit @ 10 is 0.010712407991587802
04/13/2023, 09:23:07: test ncdg @ 5 is 0.004104134509248967
04/13/2023, 09:23:07: test ncdg @ 10 is 0.005651834346122579
04/13/2023, 09:23:07: recall increases from 0.008609358569926394 ----> 0.011106729758149317 at epoch 4
04/13/2023, 09:23:40: test hit @ 1 is 0.001905888538380652
04/13/2023, 09:23:40: test hit @ 5 is 0.006177707676130389
04/13/2023, 09:23:40: test hit @ 10 is 0.011303890641430074
04/13/2023, 09:23:40: test ncdg @ 5 is 0.004049546225493121
04/13/2023, 09:23:40: test ncdg @ 10 is 0.0057064700797284365
04/13/2023, 09:23:40: recall increases from 0.011369610935856993 ----> 0.01150105152471083 at epoch 4
04/13/2023, 09:23:40: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_norep.pt
04/13/2023, 09:23:41: ---------- training epoch 5 ----------
04/13/2023, 09:23:59: total loss for 88000 steps : 970.4403491020203
04/13/2023, 09:27:23: total loss for 89000 steps : 970.5123022198677
04/13/2023, 09:30:48: total loss for 90000 steps : 965.4453492760658
04/13/2023, 09:34:13: total loss for 91000 steps : 962.3378201127052
04/13/2023, 09:37:37: total loss for 92000 steps : 958.9810611009598
04/13/2023, 09:41:00: total loss for 93000 steps : 954.8008885979652
04/13/2023, 09:44:22: total loss for 94000 steps : 952.8252701759338
04/13/2023, 09:47:45: total loss for 95000 steps : 950.6240356564522
04/13/2023, 09:51:08: total loss for 96000 steps : 943.9004244804382
04/13/2023, 09:54:32: total loss for 97000 steps : 942.1026842594147
04/13/2023, 09:57:54: total loss for 98000 steps : 940.4342664480209
04/13/2023, 10:01:17: total loss for 99000 steps : 933.9028518199921
04/13/2023, 10:04:35: total loss for 100000 steps : 932.745495557785
04/13/2023, 10:07:58: total loss for 101000 steps : 928.256828546524
04/13/2023, 10:11:17: total loss for 102000 steps : 926.6585706472397
04/13/2023, 10:14:36: total loss for 103000 steps : 919.956796169281
04/13/2023, 10:17:56: total loss for 104000 steps : 916.2983769774437
04/13/2023, 10:21:13: total loss for 105000 steps : 914.2568919062614
04/13/2023, 10:22:52: ---------- start evaluation after epoch 5 ----------
04/13/2023, 10:32:45: validation hit @ 1 is 0.0030231335436382754
04/13/2023, 10:32:45: validation hit @ 5 is 0.007754994742376446
04/13/2023, 10:32:45: validation hit @ 10 is 0.013866982124079916
04/13/2023, 10:32:45: validation ncdg @ 5 is 0.005417880611639295
04/13/2023, 10:32:45: validation ncdg @ 10 is 0.007368740327510745
04/13/2023, 10:32:57: validation hit @ 1 is 0.0033517350157728706
04/13/2023, 10:32:57: validation hit @ 5 is 0.009069400630914827
04/13/2023, 10:32:57: validation hit @ 10 is 0.014589905362776025
04/13/2023, 10:32:57: validation ncdg @ 5 is 0.006251649390308585
04/13/2023, 10:32:57: validation ncdg @ 10 is 0.008033744636706027
04/13/2023, 10:42:41: test hit @ 1 is 0.0024316508937960043
04/13/2023, 10:42:41: test hit @ 5 is 0.008280757097791799
04/13/2023, 10:42:41: test hit @ 10 is 0.012946898002103049
04/13/2023, 10:42:41: test ncdg @ 5 is 0.005360683575662465
04/13/2023, 10:42:41: test ncdg @ 10 is 0.006872284139535043
04/13/2023, 10:42:41: recall increases from 0.011106729758149317 ----> 0.013866982124079916 at epoch 5
04/13/2023, 10:43:08: test hit @ 1 is 0.0031545741324921135
04/13/2023, 10:43:08: test hit @ 5 is 0.00814931650893796
04/13/2023, 10:43:08: test hit @ 10 is 0.013275499474237645
04/13/2023, 10:43:08: test ncdg @ 5 is 0.005612232515681965
04/13/2023, 10:43:08: test ncdg @ 10 is 0.0072742667580930585
04/13/2023, 10:43:08: recall increases from 0.01150105152471083 ----> 0.014589905362776025 at epoch 5
04/13/2023, 10:43:08: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_norep.pt
04/13/2023, 10:43:10: ---------- training epoch 6 ----------
04/13/2023, 10:44:52: total loss for 106000 steps : 911.0094305872917
04/13/2023, 10:48:17: total loss for 107000 steps : 903.4187023043633
04/13/2023, 10:51:32: total loss for 108000 steps : 900.8681064844131
04/13/2023, 10:54:55: total loss for 109000 steps : 896.9160798788071
04/13/2023, 10:58:19: total loss for 110000 steps : 892.561641395092
04/13/2023, 11:01:47: total loss for 111000 steps : 889.8669120073318
04/13/2023, 11:05:17: total loss for 112000 steps : 886.6401876807213
04/13/2023, 11:08:46: total loss for 113000 steps : 881.3310844302177
04/13/2023, 11:12:14: total loss for 114000 steps : 878.8121195435524
04/13/2023, 11:15:42: total loss for 115000 steps : 873.4855769276619
04/13/2023, 11:19:08: total loss for 116000 steps : 870.54507625103
04/13/2023, 11:22:35: total loss for 117000 steps : 869.0908742547035
04/13/2023, 11:25:59: total loss for 118000 steps : 863.8142831325531
04/13/2023, 11:29:21: total loss for 119000 steps : 856.6221040487289
04/13/2023, 11:32:39: total loss for 120000 steps : 853.279660820961
04/13/2023, 11:35:57: total loss for 121000 steps : 849.5519123077393
04/13/2023, 11:39:12: total loss for 122000 steps : 844.3964686393738
04/13/2023, 11:42:29: total loss for 123000 steps : 840.7968864440918
04/13/2023, 11:42:45: ---------- start evaluation after epoch 6 ----------
04/13/2023, 11:52:46: validation hit @ 1 is 0.004008937960042061
04/13/2023, 11:52:46: validation hit @ 5 is 0.01084384858044164
04/13/2023, 11:52:46: validation hit @ 10 is 0.015970031545741326
04/13/2023, 11:52:46: validation ncdg @ 5 is 0.007448355408514905
04/13/2023, 11:52:46: validation ncdg @ 10 is 0.009100261657168126
04/13/2023, 11:53:05: validation hit @ 1 is 0.004666140904311251
04/13/2023, 11:53:05: validation hit @ 5 is 0.011238170347003154
04/13/2023, 11:53:05: validation hit @ 10 is 0.01695583596214511
04/13/2023, 11:53:05: validation ncdg @ 5 is 0.00802664181628928
04/13/2023, 11:53:05: validation ncdg @ 10 is 0.009888586610604003
04/13/2023, 12:02:49: test hit @ 1 is 0.003943217665615142
04/13/2023, 12:02:49: test hit @ 5 is 0.00946372239747634
04/13/2023, 12:02:49: test hit @ 10 is 0.014129863301787593
04/13/2023, 12:02:49: test ncdg @ 5 is 0.006735320940969033
04/13/2023, 12:02:49: test ncdg @ 10 is 0.008239626442596381
04/13/2023, 12:02:49: recall increases from 0.013866982124079916 ----> 0.015970031545741326 at epoch 6
04/13/2023, 12:03:23: test hit @ 1 is 0.0033517350157728706
04/13/2023, 12:03:23: test hit @ 5 is 0.008543638275499475
04/13/2023, 12:03:23: test hit @ 10 is 0.012618296529968454
04/13/2023, 12:03:23: test ncdg @ 5 is 0.006043700790163803
04/13/2023, 12:03:23: test ncdg @ 10 is 0.007347803291292784
04/13/2023, 12:03:23: recall increases from 0.014589905362776025 ----> 0.01695583596214511 at epoch 6
04/13/2023, 12:03:23: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_norep.pt
04/13/2023, 12:03:24: ---------- training epoch 7 ----------
04/13/2023, 12:06:22: total loss for 124000 steps : 835.3736679553986
04/13/2023, 12:09:37: total loss for 125000 steps : 829.6472373604774
04/13/2023, 12:12:50: total loss for 126000 steps : 827.0767704844475
04/13/2023, 12:16:04: total loss for 127000 steps : 823.664303123951
04/13/2023, 12:19:18: total loss for 128000 steps : 817.2602778077126
04/13/2023, 12:22:31: total loss for 129000 steps : 813.1910324692726
04/13/2023, 12:25:46: total loss for 130000 steps : 808.5743896961212
04/13/2023, 12:29:01: total loss for 131000 steps : 803.8738684058189
04/13/2023, 12:32:13: total loss for 132000 steps : 799.5843413472176
04/13/2023, 12:35:27: total loss for 133000 steps : 793.5990081429482
04/13/2023, 12:38:35: total loss for 134000 steps : 789.6754013299942
04/13/2023, 12:41:50: total loss for 135000 steps : 786.2264248728752
04/13/2023, 12:45:09: total loss for 136000 steps : 781.7849254608154
04/13/2023, 12:48:29: total loss for 137000 steps : 778.6086109280586
04/13/2023, 12:51:49: total loss for 138000 steps : 771.405228972435
04/13/2023, 12:55:11: total loss for 139000 steps : 766.9331014156342
04/13/2023, 12:58:33: total loss for 140000 steps : 761.6262183785439
04/13/2023, 13:00:43: ---------- start evaluation after epoch 7 ----------
04/13/2023, 13:10:40: validation hit @ 1 is 0.005126182965299685
04/13/2023, 13:10:40: validation hit @ 5 is 0.011106729758149317
04/13/2023, 13:10:40: validation hit @ 10 is 0.01689011566771819
04/13/2023, 13:10:40: validation ncdg @ 5 is 0.008053349837136351
04/13/2023, 13:10:40: validation ncdg @ 10 is 0.00991896942882473
04/13/2023, 13:11:07: validation hit @ 1 is 0.0048633017875920085
04/13/2023, 13:11:07: validation hit @ 5 is 0.012618296529968454
04/13/2023, 13:11:07: validation hit @ 10 is 0.018073080967402733
04/13/2023, 13:11:07: validation ncdg @ 5 is 0.008840085231125687
04/13/2023, 13:11:07: validation ncdg @ 10 is 0.010624676760144126
04/13/2023, 13:20:36: test hit @ 1 is 0.004337539432176656
04/13/2023, 13:20:36: test hit @ 5 is 0.009069400630914827
04/13/2023, 13:20:36: test hit @ 10 is 0.013669821240799159
04/13/2023, 13:20:36: test ncdg @ 5 is 0.006645343480002811
04/13/2023, 13:20:36: test ncdg @ 10 is 0.00812660176468765
04/13/2023, 13:20:36: recall increases from 0.015970031545741326 ----> 0.01689011566771819 at epoch 7
04/13/2023, 13:21:28: test hit @ 1 is 0.00407465825446898
04/13/2023, 13:21:28: test hit @ 5 is 0.009266561514195583
04/13/2023, 13:21:28: test hit @ 10 is 0.014721345951629864
04/13/2023, 13:21:28: test ncdg @ 5 is 0.006703629468887411
04/13/2023, 13:21:28: test ncdg @ 10 is 0.008448047458783556
04/13/2023, 13:21:28: recall increases from 0.01695583596214511 ----> 0.018073080967402733 at epoch 7
04/13/2023, 13:21:28: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_norep.pt
04/13/2023, 13:21:29: ---------- training epoch 8 ----------
04/13/2023, 13:22:41: total loss for 141000 steps : 753.9826334118843
04/13/2023, 13:26:11: total loss for 142000 steps : 750.5018206238747
04/13/2023, 13:29:39: total loss for 143000 steps : 742.6796109080315
04/13/2023, 13:33:06: total loss for 144000 steps : 739.7750724554062
04/13/2023, 13:36:35: total loss for 145000 steps : 733.6389067769051
04/13/2023, 13:39:58: total loss for 146000 steps : 731.4512310028076
04/13/2023, 13:43:26: total loss for 147000 steps : 725.6631284952164
04/13/2023, 13:46:52: total loss for 148000 steps : 718.2430196404457
04/13/2023, 13:50:17: total loss for 149000 steps : 714.2136390805244
04/13/2023, 13:53:43: total loss for 150000 steps : 707.517604291439
04/13/2023, 13:57:06: total loss for 151000 steps : 702.2973002195358
04/13/2023, 14:00:32: total loss for 152000 steps : 699.8699971437454
04/13/2023, 14:03:56: total loss for 153000 steps : 693.5398295521736
04/13/2023, 14:07:22: total loss for 154000 steps : 689.0353115200996
04/13/2023, 14:10:49: total loss for 155000 steps : 681.3777655363083
04/13/2023, 14:14:14: total loss for 156000 steps : 677.6680911779404
04/13/2023, 14:17:47: total loss for 157000 steps : 672.77079474926
04/13/2023, 14:21:15: total loss for 158000 steps : 665.1515800356865
04/13/2023, 14:22:07: ---------- start evaluation after epoch 8 ----------
04/13/2023, 14:32:04: validation hit @ 1 is 0.004666140904311251
04/13/2023, 14:32:04: validation hit @ 5 is 0.011238170347003154
04/13/2023, 14:32:04: validation hit @ 10 is 0.015970031545741326
04/13/2023, 14:32:04: validation ncdg @ 5 is 0.007943086077996682
04/13/2023, 14:32:04: validation ncdg @ 10 is 0.009462398223263164
04/13/2023, 14:32:25: validation hit @ 1 is 0.00473186119873817
04/13/2023, 14:32:25: validation hit @ 5 is 0.011566771819137749
04/13/2023, 14:32:25: validation hit @ 10 is 0.016692954784437435
04/13/2023, 14:32:25: validation ncdg @ 5 is 0.008174511598109948
04/13/2023, 14:32:25: validation ncdg @ 10 is 0.00983238841267165
04/13/2023, 14:42:02: test hit @ 1 is 0.003746056782334385
04/13/2023, 14:42:02: test hit @ 5 is 0.008412197686645636
04/13/2023, 14:42:02: test hit @ 10 is 0.012815457413249211
04/13/2023, 14:42:02: test ncdg @ 5 is 0.006069004365762101
04/13/2023, 14:42:02: test ncdg @ 10 is 0.0074797946970239304
04/13/2023, 14:42:50: test hit @ 1 is 0.004140378548895899
04/13/2023, 14:42:50: test hit @ 5 is 0.009726603575184017
04/13/2023, 14:42:50: test hit @ 10 is 0.014195583596214511
04/13/2023, 14:42:50: test ncdg @ 5 is 0.006926521377616646
04/13/2023, 14:42:50: test ncdg @ 10 is 0.008359218473687447
04/13/2023, 14:42:50: ---------- training epoch 9 ----------
04/13/2023, 14:45:28: total loss for 159000 steps : 658.1950641870499
04/13/2023, 14:48:58: total loss for 160000 steps : 649.6704178452492
04/13/2023, 14:52:26: total loss for 161000 steps : 646.7582693099976
04/13/2023, 14:55:51: total loss for 162000 steps : 641.6821457147598
04/13/2023, 14:59:16: total loss for 163000 steps : 635.799193918705
04/13/2023, 15:02:40: total loss for 164000 steps : 629.5659771561623
04/13/2023, 15:06:04: total loss for 165000 steps : 626.9449375271797
04/13/2023, 15:09:28: total loss for 166000 steps : 619.1199120879173
04/13/2023, 15:12:53: total loss for 167000 steps : 613.5930240750313
04/13/2023, 15:16:19: total loss for 168000 steps : 608.5782033205032
04/13/2023, 15:19:48: total loss for 169000 steps : 606.4794014394283
04/13/2023, 15:23:17: total loss for 170000 steps : 596.565060287714
04/13/2023, 15:26:47: total loss for 171000 steps : 594.9458030462265
04/13/2023, 15:30:11: total loss for 172000 steps : 586.8426387310028
04/13/2023, 15:33:41: total loss for 173000 steps : 578.6831098496914
04/13/2023, 15:37:11: total loss for 174000 steps : 574.191086024046
04/13/2023, 15:40:38: total loss for 175000 steps : 568.2816137969494
04/13/2023, 15:43:30: ---------- start evaluation after epoch 9 ----------
04/13/2023, 15:53:26: validation hit @ 1 is 0.00473186119873817
04/13/2023, 15:53:26: validation hit @ 5 is 0.010318086225026288
04/13/2023, 15:53:26: validation hit @ 10 is 0.015247108307045216
04/13/2023, 15:53:26: validation ncdg @ 5 is 0.007567837888463353
04/13/2023, 15:53:26: validation ncdg @ 10 is 0.009149980083367005
04/13/2023, 15:53:52: validation hit @ 1 is 0.004337539432176656
04/13/2023, 15:53:52: validation hit @ 5 is 0.010778128286014722
04/13/2023, 15:53:52: validation hit @ 10 is 0.015904311251314408
04/13/2023, 15:53:52: validation ncdg @ 5 is 0.007573881446769361
04/13/2023, 15:53:52: validation ncdg @ 10 is 0.00920614702558411
04/13/2023, 16:03:22: test hit @ 1 is 0.003548895899053628
04/13/2023, 16:03:22: test hit @ 5 is 0.008346477392218717
04/13/2023, 16:03:22: test hit @ 10 is 0.012026813880126183
04/13/2023, 16:03:22: test ncdg @ 5 is 0.00604541222483999
04/13/2023, 16:03:22: test ncdg @ 10 is 0.007232614746592653
04/13/2023, 16:04:11: test hit @ 1 is 0.003614616193480547
04/13/2023, 16:04:11: test hit @ 5 is 0.008412197686645636
04/13/2023, 16:04:11: test hit @ 10 is 0.012946898002103049
04/13/2023, 16:04:11: test ncdg @ 5 is 0.006084775533860677
04/13/2023, 16:04:11: test ncdg @ 10 is 0.007547919960998342
04/13/2023, 16:04:11: ---------- training epoch 10 ----------
04/13/2023, 16:04:47: total loss for 176000 steps : 564.4425605237484
04/13/2023, 16:08:15: total loss for 177000 steps : 553.3795439600945
04/13/2023, 16:11:43: total loss for 178000 steps : 549.9326277375221
04/13/2023, 16:15:10: total loss for 179000 steps : 546.6876873373985
04/13/2023, 16:18:30: total loss for 180000 steps : 540.380939155817
04/13/2023, 16:21:41: total loss for 181000 steps : 533.662811011076
04/13/2023, 16:25:05: total loss for 182000 steps : 529.6182178854942
04/13/2023, 16:28:33: total loss for 183000 steps : 523.454642444849
04/13/2023, 16:32:02: total loss for 184000 steps : 516.1781836748123
04/13/2023, 16:35:32: total loss for 185000 steps : 512.8450262546539
04/13/2023, 16:39:02: total loss for 186000 steps : 507.75417640805244
04/13/2023, 16:42:25: total loss for 187000 steps : 500.6005767285824
