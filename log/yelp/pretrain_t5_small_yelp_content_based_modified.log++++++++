04/14/2023, 22:21:46: Namespace(seed=2022, data_dir='data/', logging_dir='log/yelp/pretrain_t5_small_yelp_content_based_modified.log', model_dir='model/yelp/pretrain_t5_small_yelp_content_based_modified.pt', task='yelp', max_history=20, sequential_num=10, negative_sample=2, yes_no_sample=5, direct_item_proportion=2, train_sequential_item_batch=64, train_sequential_yesno_batch=32, train_direct_yesno_batch=48, train_direct_candidate_batch=12, train_direct_straightforward_batch=48, meta_title_batch=128, meta_description_batch=12, meta_category_batch=128, meta_epochs=10, meta_lr=0.0001, review_user_batch=16, review_item_batch=16, review_epochs=2, review_lr=0.0001, model_type='t5-small', epochs=20, lr=0.001, clip=1.0, logging_step=1000, warmup_prop=0.05, gradient_accumulation_steps=1, weight_decay=0.01, adam_eps=1e-06, dropout=0.1, alpha=2, multiGPU=True, distributed=True, gpu='5,6', local_rank=0, evaluation_method='sequential_item', evaluation_template_id=0, number_of_items=20034, item_representation='content_based', cluster_number=55, cluster_size=100, optimal_width_in_CF=False, category_no_repetition=False, last_token_no_repetition=False, hybrid_order='CF_first', data_order='random', remapped_data_order='original', resolution=2, max_random_number=30000, min_random_number=1000, overlap=0, base=10, random_initialization_embedding=False, whole_word_embedding='shijie', no_pretrain=False, use_meta_data=False, use_review_data=False, remove_last_item=False, remove_first_item=False, eval_only=False, check_data=True)
04/14/2023, 22:21:48: Process Launching at GPU 0
04/14/2023, 22:21:48: Process Launching at GPU 1
04/14/2023, 22:21:49: Building train loader at GPU 0
04/14/2023, 22:21:49: loading data ...
04/14/2023, 22:21:49: Building train loader at GPU 1
04/14/2023, 22:21:49: *** use content_based representation, extend vocab ***
04/14/2023, 22:21:52: finished loading data
04/14/2023, 22:21:52: length of training data is 17583
04/14/2023, 22:21:52: loading model ...
04/14/2023, 22:21:52: using only sequential data, and all possible sequences are here
04/14/2023, 22:21:52: use pretrained T5
04/14/2023, 22:21:57: Batch per epoch: 17583
04/14/2023, 22:21:57: Total steps: 351660
04/14/2023, 22:21:57: Warmup proportion:
04/14/2023, 22:21:57: Warm up steps: 17583
04/14/2023, 22:21:57: model dataparallel set
04/14/2023, 22:21:57: start training
04/14/2023, 22:21:59: rank is 0
04/14/2023, 22:22:14: ---------- training epoch 0 ----------
04/14/2023, 22:25:15: total loss for 1000 steps : 6735.327105522156
04/14/2023, 22:28:15: total loss for 2000 steps : 4550.811154842377
04/14/2023, 22:31:10: total loss for 3000 steps : 3708.575164079666
04/14/2023, 22:34:07: total loss for 4000 steps : 2991.362856388092
04/14/2023, 22:37:02: total loss for 5000 steps : 2583.214469432831
04/14/2023, 22:39:57: total loss for 6000 steps : 2397.128105401993
04/14/2023, 22:42:52: total loss for 7000 steps : 2291.5638284683228
04/14/2023, 22:45:48: total loss for 8000 steps : 2204.5057002305984
04/14/2023, 22:48:44: total loss for 9000 steps : 2128.300182580948
04/14/2023, 22:51:43: total loss for 10000 steps : 2053.075077652931
04/14/2023, 22:54:45: total loss for 11000 steps : 1974.4114109277725
04/14/2023, 22:57:44: total loss for 12000 steps : 1911.9697051048279
04/14/2023, 23:00:41: total loss for 13000 steps : 1848.6799873113632
04/14/2023, 23:03:40: total loss for 14000 steps : 1785.1444576978683
04/14/2023, 23:06:38: total loss for 15000 steps : 1735.1565432548523
04/14/2023, 23:09:36: total loss for 16000 steps : 1681.8349986076355
04/14/2023, 23:12:34: total loss for 17000 steps : 1638.879199385643
04/14/2023, 23:14:19: ---------- start evaluation after epoch 0 ----------
04/14/2023, 23:24:22: validation hit @ 1 is 0.0012486855941114617
04/14/2023, 23:24:22: validation hit @ 5 is 0.005389064143007361
04/14/2023, 23:24:22: validation hit @ 10 is 0.009200841219768665
04/14/2023, 23:24:22: validation ncdg @ 5 is 0.003275466119677395
04/14/2023, 23:24:22: validation ncdg @ 10 is 0.004498417264353796
04/14/2023, 23:24:26: validation hit @ 1 is 0.0011172450052576235
04/14/2023, 23:24:26: validation hit @ 5 is 0.005980546792849632
04/14/2023, 23:24:26: validation hit @ 10 is 0.010646687697160883
04/14/2023, 23:24:26: validation ncdg @ 5 is 0.0034737141945861178
04/14/2023, 23:24:26: validation ncdg @ 10 is 0.004969135455180695
04/14/2023, 23:34:27: test hit @ 1 is 0.0016430073606729758
04/14/2023, 23:34:27: test hit @ 5 is 0.0053233438485804415
04/14/2023, 23:34:27: test hit @ 10 is 0.009858044164037854
04/14/2023, 23:34:27: test ncdg @ 5 is 0.0033886455760951785
04/14/2023, 23:34:27: test ncdg @ 10 is 0.00483547183495517
04/14/2023, 23:34:27: recall increases from 0 ----> 0.009200841219768665 at epoch 0
04/14/2023, 23:34:35: test hit @ 1 is 0.0011172450052576235
04/14/2023, 23:34:35: test hit @ 5 is 0.004468980021030494
04/14/2023, 23:34:35: test hit @ 10 is 0.008280757097791799
04/14/2023, 23:34:35: test ncdg @ 5 is 0.00278334248550706
04/14/2023, 23:34:35: test ncdg @ 10 is 0.0040021873735430384
04/14/2023, 23:34:35: recall increases from 0 ----> 0.010646687697160883 at epoch 0
04/14/2023, 23:34:35: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_modified.pt
04/14/2023, 23:34:36: ---------- training epoch 1 ----------
04/14/2023, 23:35:52: total loss for 18000 steps : 1602.6993999481201
04/14/2023, 23:38:53: total loss for 19000 steps : 1563.8611030578613
04/14/2023, 23:41:54: total loss for 20000 steps : 1530.6577578783035
04/14/2023, 23:44:56: total loss for 21000 steps : 1505.9561700820923
04/14/2023, 23:47:56: total loss for 22000 steps : 1481.722005724907
04/14/2023, 23:50:53: total loss for 23000 steps : 1456.7560653686523
04/14/2023, 23:53:52: total loss for 24000 steps : 1435.51997756958
04/14/2023, 23:56:52: total loss for 25000 steps : 1416.1805893182755
04/14/2023, 23:59:50: total loss for 26000 steps : 1403.418965935707
04/15/2023, 00:02:49: total loss for 27000 steps : 1381.0285202264786
04/15/2023, 00:05:47: total loss for 28000 steps : 1366.0838249921799
04/15/2023, 00:08:46: total loss for 29000 steps : 1348.1818462610245
04/15/2023, 00:11:45: total loss for 30000 steps : 1328.518716931343
04/15/2023, 00:14:47: total loss for 31000 steps : 1312.9212718009949
04/15/2023, 00:17:46: total loss for 32000 steps : 1298.3601644039154
04/15/2023, 00:20:44: total loss for 33000 steps : 1283.3098442554474
04/15/2023, 00:23:42: total loss for 34000 steps : 1270.2838948965073
04/15/2023, 00:26:40: total loss for 35000 steps : 1256.5537889003754
04/15/2023, 00:27:09: ---------- start evaluation after epoch 1 ----------
04/15/2023, 00:37:06: validation hit @ 1 is 0.003746056782334385
04/15/2023, 00:37:06: validation hit @ 5 is 0.012946898002103049
04/15/2023, 00:37:06: validation hit @ 10 is 0.02089905362776025
04/15/2023, 00:37:06: validation ncdg @ 5 is 0.00829781039358957
04/15/2023, 00:37:06: validation ncdg @ 10 is 0.01086781833006647
04/15/2023, 00:37:07: validation hit @ 1 is 0.0032860147213459516
04/15/2023, 00:37:07: validation hit @ 5 is 0.012026813880126183
04/15/2023, 00:37:07: validation hit @ 10 is 0.01965036803364879
04/15/2023, 00:37:07: validation ncdg @ 5 is 0.007625499545559196
04/15/2023, 00:37:07: validation ncdg @ 10 is 0.010052437268755193
04/15/2023, 00:47:07: test hit @ 1 is 0.0025630914826498424
04/15/2023, 00:47:07: test hit @ 5 is 0.010055205047318612
04/15/2023, 00:47:07: test hit @ 10 is 0.018467402733964248
04/15/2023, 00:47:07: test ncdg @ 5 is 0.006326400115259841
04/15/2023, 00:47:07: test ncdg @ 10 is 0.008990359582699543
04/15/2023, 00:47:07: recall increases from 0.010646687697160883 ----> 0.02089905362776025 at epoch 1
04/15/2023, 00:47:07: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_modified.pt
04/15/2023, 00:47:14: test hit @ 1 is 0.0034831756046267088
04/15/2023, 00:47:14: test hit @ 5 is 0.012026813880126183
04/15/2023, 00:47:14: test hit @ 10 is 0.01905888538380652
04/15/2023, 00:47:14: test ncdg @ 5 is 0.007740909634200605
04/15/2023, 00:47:14: test ncdg @ 10 is 0.010027789218354864
04/15/2023, 00:47:14: recall increases from 0.009200841219768665 ----> 0.01965036803364879 at epoch 1
04/15/2023, 00:47:14: ---------- training epoch 2 ----------
04/15/2023, 00:49:46: total loss for 36000 steps : 1244.0947167873383
04/15/2023, 00:52:48: total loss for 37000 steps : 1237.711317062378
04/15/2023, 00:55:49: total loss for 38000 steps : 1224.9259053468704
04/15/2023, 00:58:52: total loss for 39000 steps : 1222.2111324071884
04/15/2023, 01:01:54: total loss for 40000 steps : 1208.65108025074
04/15/2023, 01:04:56: total loss for 41000 steps : 1202.7260401248932
04/15/2023, 01:07:56: total loss for 42000 steps : 1195.4480966329575
04/15/2023, 01:10:54: total loss for 43000 steps : 1189.2634137868881
04/15/2023, 01:13:53: total loss for 44000 steps : 1184.3935896158218
04/15/2023, 01:16:52: total loss for 45000 steps : 1173.8182784318924
04/15/2023, 01:19:50: total loss for 46000 steps : 1172.0465397834778
04/15/2023, 01:22:50: total loss for 47000 steps : 1165.6026121377945
04/15/2023, 01:25:48: total loss for 48000 steps : 1158.7665094137192
04/15/2023, 01:28:47: total loss for 49000 steps : 1152.9813171625137
04/15/2023, 01:31:46: total loss for 50000 steps : 1149.2199090719223
04/15/2023, 01:34:47: total loss for 51000 steps : 1144.3577115535736
04/15/2023, 01:37:46: total loss for 52000 steps : 1137.9087352752686
04/15/2023, 01:40:01: ---------- start evaluation after epoch 2 ----------
04/15/2023, 01:50:09: validation hit @ 1 is 0.003548895899053628
04/15/2023, 01:50:09: validation hit @ 5 is 0.014721345951629864
04/15/2023, 01:50:09: validation hit @ 10 is 0.024316508937960044
04/15/2023, 01:50:09: validation ncdg @ 5 is 0.009155846602991551
04/15/2023, 01:50:09: validation ncdg @ 10 is 0.01222486779591551
04/15/2023, 01:50:13: validation hit @ 1 is 0.005126182965299685
04/15/2023, 01:50:13: validation hit @ 5 is 0.018007360672975814
04/15/2023, 01:50:13: validation hit @ 10 is 0.029245531019978968
04/15/2023, 01:50:13: validation ncdg @ 5 is 0.011459198022394848
04/15/2023, 01:50:13: validation ncdg @ 10 is 0.015049009053654444
04/15/2023, 02:00:22: test hit @ 1 is 0.003746056782334385
04/15/2023, 02:00:22: test hit @ 5 is 0.014392744479495269
04/15/2023, 02:00:22: test hit @ 10 is 0.023987907465825447
04/15/2023, 02:00:22: test ncdg @ 5 is 0.009042300563100129
04/15/2023, 02:00:22: test ncdg @ 10 is 0.01212047160783347
04/15/2023, 02:00:22: recall increases from 0.01965036803364879 ----> 0.024316508937960044 at epoch 2
04/15/2023, 02:00:30: test hit @ 1 is 0.0034831756046267088
04/15/2023, 02:00:30: test hit @ 5 is 0.01570715036803365
04/15/2023, 02:00:30: test hit @ 10 is 0.02793112513144059
04/15/2023, 02:00:30: test ncdg @ 5 is 0.00967193375644756
04/15/2023, 02:00:30: test ncdg @ 10 is 0.013575448953310322
04/15/2023, 02:00:30: recall increases from 0.02089905362776025 ----> 0.029245531019978968 at epoch 2
04/15/2023, 02:00:30: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_modified.pt
04/15/2023, 02:00:31: ---------- training epoch 3 ----------
04/15/2023, 02:01:18: total loss for 53000 steps : 1134.620361328125
04/15/2023, 02:04:22: total loss for 54000 steps : 1129.7138657569885
04/15/2023, 02:07:26: total loss for 55000 steps : 1126.750264763832
04/15/2023, 02:10:30: total loss for 56000 steps : 1122.7175887823105
04/15/2023, 02:13:34: total loss for 57000 steps : 1114.8609886169434
04/15/2023, 02:16:39: total loss for 58000 steps : 1112.8246428966522
04/15/2023, 02:19:44: total loss for 59000 steps : 1108.6726957559586
04/15/2023, 02:22:48: total loss for 60000 steps : 1106.1393104791641
04/15/2023, 02:25:54: total loss for 61000 steps : 1102.5717715024948
04/15/2023, 02:28:57: total loss for 62000 steps : 1098.6684340238571
04/15/2023, 02:32:01: total loss for 63000 steps : 1095.9251658320427
04/15/2023, 02:35:06: total loss for 64000 steps : 1091.115432858467
04/15/2023, 02:38:11: total loss for 65000 steps : 1088.2190311551094
04/15/2023, 02:41:13: total loss for 66000 steps : 1085.2991514205933
04/15/2023, 02:44:15: total loss for 67000 steps : 1081.3752786517143
04/15/2023, 02:47:17: total loss for 68000 steps : 1077.7053964734077
04/15/2023, 02:50:20: total loss for 69000 steps : 1073.5227526426315
04/15/2023, 02:53:24: total loss for 70000 steps : 1070.2070559859276
04/15/2023, 02:54:24: ---------- start evaluation after epoch 3 ----------
04/15/2023, 03:04:42: validation hit @ 1 is 0.004666140904311251
04/15/2023, 03:04:42: validation hit @ 5 is 0.01965036803364879
04/15/2023, 03:04:42: validation hit @ 10 is 0.03259726603575184
04/15/2023, 03:04:42: validation ncdg @ 5 is 0.012168964040312232
04/15/2023, 03:04:42: validation ncdg @ 10 is 0.016377817588466216
04/15/2023, 03:04:43: validation hit @ 1 is 0.007229232386961094
04/15/2023, 03:04:43: validation hit @ 5 is 0.023462145110410094
04/15/2023, 03:04:43: validation hit @ 10 is 0.037723449001051526
04/15/2023, 03:04:43: validation ncdg @ 5 is 0.015334469956458308
04/15/2023, 03:04:43: validation ncdg @ 10 is 0.01991418729949525
04/15/2023, 03:14:59: test hit @ 1 is 0.006243427970557308
04/15/2023, 03:14:59: test hit @ 5 is 0.02116193480546793
04/15/2023, 03:14:59: test hit @ 10 is 0.03299158780231336
04/15/2023, 03:14:59: test ncdg @ 5 is 0.01362393265155577
04/15/2023, 03:14:59: test ncdg @ 10 is 0.017434887571069306
04/15/2023, 03:14:59: recall increases from 0.029245531019978968 ----> 0.037723449001051526 at epoch 3
04/15/2023, 03:14:59: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_modified.pt
04/15/2023, 03:15:03: test hit @ 1 is 0.004337539432176656
04/15/2023, 03:15:03: test hit @ 5 is 0.019387486855941116
04/15/2023, 03:15:03: test hit @ 10 is 0.03174290220820189
04/15/2023, 03:15:03: test ncdg @ 5 is 0.011967320136237376
04/15/2023, 03:15:03: test ncdg @ 10 is 0.015940852914133573
04/15/2023, 03:15:03: recall increases from 0.024316508937960044 ----> 0.03259726603575184 at epoch 3
04/15/2023, 03:15:03: ---------- training epoch 4 ----------
04/15/2023, 03:17:05: total loss for 71000 steps : 1065.2607503533363
04/15/2023, 03:20:07: total loss for 72000 steps : 1063.761734187603
04/15/2023, 03:23:13: total loss for 73000 steps : 1059.07841694355
04/15/2023, 03:26:17: total loss for 74000 steps : 1056.0599558353424
04/15/2023, 03:29:22: total loss for 75000 steps : 1053.8193212151527
04/15/2023, 03:32:27: total loss for 76000 steps : 1049.2426570653915
04/15/2023, 03:35:34: total loss for 77000 steps : 1047.5517528653145
04/15/2023, 03:38:41: total loss for 78000 steps : 1045.2998004555702
04/15/2023, 03:41:47: total loss for 79000 steps : 1042.9582116007805
04/15/2023, 03:44:52: total loss for 80000 steps : 1037.742916405201
04/15/2023, 03:47:57: total loss for 81000 steps : 1034.008191049099
04/15/2023, 03:51:01: total loss for 82000 steps : 1032.910806298256
04/15/2023, 03:54:03: total loss for 83000 steps : 1028.7133114933968
04/15/2023, 03:57:06: total loss for 84000 steps : 1023.3493139147758
04/15/2023, 04:00:07: total loss for 85000 steps : 1022.7397003173828
04/15/2023, 04:03:10: total loss for 86000 steps : 1017.9477862715721
04/15/2023, 04:06:11: total loss for 87000 steps : 1015.0762358903885
04/15/2023, 04:08:56: ---------- start evaluation after epoch 4 ----------
04/15/2023, 04:19:19: validation hit @ 1 is 0.005389064143007361
04/15/2023, 04:19:19: validation hit @ 5 is 0.019781808622502627
04/15/2023, 04:19:19: validation hit @ 10 is 0.03463459516298633
04/15/2023, 04:19:19: validation ncdg @ 5 is 0.012610439740716989
04/15/2023, 04:19:19: validation ncdg @ 10 is 0.017370498149606478
04/15/2023, 04:19:20: validation hit @ 1 is 0.008477917981072555
04/15/2023, 04:19:20: validation hit @ 5 is 0.02576235541535226
04/15/2023, 04:19:20: validation hit @ 10 is 0.04265247108307045
04/15/2023, 04:19:20: validation ncdg @ 5 is 0.01711833848198
04/15/2023, 04:19:20: validation ncdg @ 10 is 0.02256847485395134
04/15/2023, 04:29:39: test hit @ 1 is 0.00749211356466877
04/15/2023, 04:29:39: test hit @ 5 is 0.022476340694006308
04/15/2023, 04:29:39: test hit @ 10 is 0.03706624605678233
04/15/2023, 04:29:39: test ncdg @ 5 is 0.015060529704299578
04/15/2023, 04:29:39: test ncdg @ 10 is 0.0197440759162495
04/15/2023, 04:29:39: recall increases from 0.037723449001051526 ----> 0.04265247108307045 at epoch 4
04/15/2023, 04:29:39: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_modified.pt
04/15/2023, 04:29:40: test hit @ 1 is 0.005389064143007361
04/15/2023, 04:29:40: test hit @ 5 is 0.018533123028391166
04/15/2023, 04:29:40: test hit @ 10 is 0.032268664563617246
04/15/2023, 04:29:40: test ncdg @ 5 is 0.011990640919572445
04/15/2023, 04:29:40: test ncdg @ 10 is 0.016424539515745077
04/15/2023, 04:29:40: recall increases from 0.03259726603575184 ----> 0.03463459516298633 at epoch 4
04/15/2023, 04:29:40: ---------- training epoch 5 ----------
04/15/2023, 04:29:56: total loss for 88000 steps : 1012.9907292723656
04/15/2023, 04:32:59: total loss for 89000 steps : 1009.1749200820923
04/15/2023, 04:36:02: total loss for 90000 steps : 1005.1436342000961
04/15/2023, 04:39:07: total loss for 91000 steps : 1001.2073600888252
04/15/2023, 04:42:11: total loss for 92000 steps : 1000.0968708992004
04/15/2023, 04:45:15: total loss for 93000 steps : 996.1051186323166
04/15/2023, 04:48:20: total loss for 94000 steps : 994.1595155000687
04/15/2023, 04:51:24: total loss for 95000 steps : 989.7359302043915
04/15/2023, 04:54:31: total loss for 96000 steps : 984.8071636557579
04/15/2023, 04:57:36: total loss for 97000 steps : 982.4674593806267
04/15/2023, 05:00:42: total loss for 98000 steps : 979.0871474146843
04/15/2023, 05:03:49: total loss for 99000 steps : 977.1579676866531
04/15/2023, 05:06:53: total loss for 100000 steps : 969.271468102932
04/15/2023, 05:09:55: total loss for 101000 steps : 968.8480807542801
04/15/2023, 05:12:57: total loss for 102000 steps : 966.0721934437752
04/15/2023, 05:16:01: total loss for 103000 steps : 963.0418978333473
04/15/2023, 05:19:03: total loss for 104000 steps : 958.5536788105965
04/15/2023, 05:22:05: total loss for 105000 steps : 952.692603468895
04/15/2023, 05:23:35: ---------- start evaluation after epoch 5 ----------
04/15/2023, 05:33:57: validation hit @ 1 is 0.006703470031545741
04/15/2023, 05:33:57: validation hit @ 5 is 0.02425078864353312
04/15/2023, 05:33:57: validation hit @ 10 is 0.03877497371188223
04/15/2023, 05:33:57: validation ncdg @ 5 is 0.015459655134724776
04/15/2023, 05:33:57: validation ncdg @ 10 is 0.020135771845940394
04/15/2023, 05:34:00: validation hit @ 1 is 0.009135120925341746
04/15/2023, 05:34:00: validation hit @ 5 is 0.02793112513144059
04/15/2023, 05:34:00: validation hit @ 10 is 0.04390115667718191
04/15/2023, 05:34:00: validation ncdg @ 5 is 0.018529165755084284
04/15/2023, 05:34:00: validation ncdg @ 10 is 0.02362456680838631
04/15/2023, 05:44:13: test hit @ 1 is 0.006309148264984227
04/15/2023, 05:44:13: test hit @ 5 is 0.021556256572029444
04/15/2023, 05:44:13: test hit @ 10 is 0.03627760252365931
04/15/2023, 05:44:13: test ncdg @ 5 is 0.013878080079602863
04/15/2023, 05:44:13: test ncdg @ 10 is 0.01858243501311724
04/15/2023, 05:44:13: recall increases from 0.03463459516298633 ----> 0.03877497371188223 at epoch 5
04/15/2023, 05:44:23: test hit @ 1 is 0.008017875920084122
04/15/2023, 05:44:23: test hit @ 5 is 0.02425078864353312
04/15/2023, 05:44:23: test hit @ 10 is 0.04022082018927445
04/15/2023, 05:44:23: test ncdg @ 5 is 0.0161047828991146
04/15/2023, 05:44:23: test ncdg @ 10 is 0.021221763533066665
04/15/2023, 05:44:23: recall increases from 0.04265247108307045 ----> 0.04390115667718191 at epoch 5
04/15/2023, 05:44:23: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_modified.pt
04/15/2023, 05:44:24: ---------- training epoch 6 ----------
04/15/2023, 05:45:56: total loss for 106000 steps : 951.4235264062881
04/15/2023, 05:48:58: total loss for 107000 steps : 944.3942054510117
04/15/2023, 05:51:58: total loss for 108000 steps : 940.38004976511
04/15/2023, 05:55:01: total loss for 109000 steps : 937.6582550406456
04/15/2023, 05:58:03: total loss for 110000 steps : 936.9588176012039
04/15/2023, 06:01:06: total loss for 111000 steps : 931.2133644223213
04/15/2023, 06:04:13: total loss for 112000 steps : 928.0175069570541
04/15/2023, 06:07:18: total loss for 113000 steps : 924.1659173369408
04/15/2023, 06:10:22: total loss for 114000 steps : 920.5268879532814
04/15/2023, 06:13:27: total loss for 115000 steps : 915.2704920172691
04/15/2023, 06:16:31: total loss for 116000 steps : 909.912529706955
04/15/2023, 06:19:33: total loss for 117000 steps : 908.474637389183
04/15/2023, 06:22:36: total loss for 118000 steps : 904.2583875656128
04/15/2023, 06:25:40: total loss for 119000 steps : 900.6740875244141
04/15/2023, 06:28:43: total loss for 120000 steps : 895.9204844236374
04/15/2023, 06:31:46: total loss for 121000 steps : 892.8461047410965
04/15/2023, 06:34:47: total loss for 122000 steps : 887.1902089118958
04/15/2023, 06:37:49: total loss for 123000 steps : 882.2724226117134
04/15/2023, 06:38:05: ---------- start evaluation after epoch 6 ----------
04/15/2023, 06:48:24: validation hit @ 1 is 0.007294952681388012
04/15/2023, 06:48:24: validation hit @ 5 is 0.02444794952681388
04/15/2023, 06:48:24: validation hit @ 10 is 0.04015509989484753
04/15/2023, 06:48:24: validation ncdg @ 5 is 0.01584123162669522
04/15/2023, 06:48:24: validation ncdg @ 10 is 0.020902620105650558
04/15/2023, 06:48:28: validation hit @ 1 is 0.009792323869610936
04/15/2023, 06:48:28: validation hit @ 5 is 0.027471083070452155
04/15/2023, 06:48:28: validation hit @ 10 is 0.04206098843322818
04/15/2023, 06:48:28: validation ncdg @ 5 is 0.018551377057124813
04/15/2023, 06:48:28: validation ncdg @ 10 is 0.02323210162355056
04/15/2023, 06:58:49: test hit @ 1 is 0.006637749737118823
04/15/2023, 06:58:49: test hit @ 5 is 0.022476340694006308
04/15/2023, 06:58:49: test hit @ 10 is 0.03686908517350158
04/15/2023, 06:58:49: test ncdg @ 5 is 0.014448920067621177
04/15/2023, 06:58:49: test ncdg @ 10 is 0.01910028929471148
04/15/2023, 06:58:49: recall increases from 0.03877497371188223 ----> 0.04015509989484753 at epoch 6
04/15/2023, 06:58:55: test hit @ 1 is 0.006703470031545741
04/15/2023, 06:58:55: test hit @ 5 is 0.022082018927444796
04/15/2023, 06:58:55: test hit @ 10 is 0.03732912723449001
04/15/2023, 06:58:55: test ncdg @ 5 is 0.014366273716716851
04/15/2023, 06:58:55: test ncdg @ 10 is 0.01923436083125774
04/15/2023, 06:58:55: ---------- training epoch 7 ----------
04/15/2023, 07:01:42: total loss for 124000 steps : 878.1295766830444
04/15/2023, 07:04:44: total loss for 125000 steps : 873.4008511304855
04/15/2023, 07:07:46: total loss for 126000 steps : 869.1783785223961
04/15/2023, 07:10:47: total loss for 127000 steps : 866.2341284155846
04/15/2023, 07:13:50: total loss for 128000 steps : 861.9307680726051
04/15/2023, 07:16:52: total loss for 129000 steps : 854.8759688735008
04/15/2023, 07:19:54: total loss for 130000 steps : 850.0950167179108
04/15/2023, 07:22:57: total loss for 131000 steps : 847.0933104157448
04/15/2023, 07:26:03: total loss for 132000 steps : 842.5520960092545
04/15/2023, 07:29:10: total loss for 133000 steps : 838.2190763354301
04/15/2023, 07:32:14: total loss for 134000 steps : 833.9665879607201
04/15/2023, 07:35:17: total loss for 135000 steps : 828.2192345261574
04/15/2023, 07:38:22: total loss for 136000 steps : 825.0430038571358
04/15/2023, 07:41:25: total loss for 137000 steps : 821.1693794727325
04/15/2023, 07:44:29: total loss for 138000 steps : 812.3958140015602
04/15/2023, 07:47:34: total loss for 139000 steps : 806.4213790297508
04/15/2023, 07:50:37: total loss for 140000 steps : 805.2264748215675
04/15/2023, 07:52:39: ---------- start evaluation after epoch 7 ----------
04/15/2023, 08:03:02: validation hit @ 1 is 0.01012092534174553
04/15/2023, 08:03:02: validation hit @ 5 is 0.02911409043112513
04/15/2023, 08:03:02: validation hit @ 10 is 0.04462407991587802
04/15/2023, 08:03:02: validation ncdg @ 5 is 0.019563775945961304
04/15/2023, 08:03:02: validation ncdg @ 10 is 0.024523694478078572
04/15/2023, 08:03:03: validation hit @ 1 is 0.008412197686645636
04/15/2023, 08:03:03: validation hit @ 5 is 0.026156677181913775
04/15/2023, 08:03:03: validation hit @ 10 is 0.041995268138801264
04/15/2023, 08:03:03: validation ncdg @ 5 is 0.017291030435180647
04/15/2023, 08:03:03: validation ncdg @ 10 is 0.022349738536730997
04/15/2023, 08:13:27: test hit @ 1 is 0.006769190325972661
04/15/2023, 08:13:27: test hit @ 5 is 0.02168769716088328
04/15/2023, 08:13:27: test hit @ 10 is 0.03588328075709779
04/15/2023, 08:13:27: test ncdg @ 5 is 0.014350753866768
04/15/2023, 08:13:27: test ncdg @ 10 is 0.01892577397948472
04/15/2023, 08:13:27: recall increases from 0.04390115667718191 ----> 0.04462407991587802 at epoch 7
04/15/2023, 08:13:27: save current best model to best_model/yelp/pretrain_t5_small_yelp_content_based_modified.pt
04/15/2023, 08:13:32: test hit @ 1 is 0.006900630914826498
04/15/2023, 08:13:32: test hit @ 5 is 0.022673501577287068
04/15/2023, 08:13:32: test hit @ 10 is 0.038643533123028394
04/15/2023, 08:13:32: test ncdg @ 5 is 0.014641606433021431
04/15/2023, 08:13:32: test ncdg @ 10 is 0.0197451626713302
04/15/2023, 08:13:32: recall increases from 0.04015509989484753 ----> 0.041995268138801264 at epoch 7
04/15/2023, 08:13:32: ---------- training epoch 8 ----------
04/15/2023, 08:14:34: total loss for 141000 steps : 798.6555450558662
04/15/2023, 08:17:37: total loss for 142000 steps : 791.7769218087196
04/15/2023, 08:20:39: total loss for 143000 steps : 787.6672483086586
04/15/2023, 08:23:41: total loss for 144000 steps : 784.9114327430725
04/15/2023, 08:26:44: total loss for 145000 steps : 776.5177233815193
04/15/2023, 08:29:48: total loss for 146000 steps : 772.2852683663368
04/15/2023, 08:32:51: total loss for 147000 steps : 767.1927738189697
04/15/2023, 08:35:53: total loss for 148000 steps : 762.1253883242607
04/15/2023, 08:38:55: total loss for 149000 steps : 756.7848594784737
04/15/2023, 08:41:56: total loss for 150000 steps : 751.143545627594
04/15/2023, 08:44:58: total loss for 151000 steps : 744.5795248746872
04/15/2023, 08:48:02: total loss for 152000 steps : 740.9587730765343
04/15/2023, 08:51:05: total loss for 153000 steps : 737.3123852014542
04/15/2023, 08:54:08: total loss for 154000 steps : 729.2181950211525
04/15/2023, 08:57:11: total loss for 155000 steps : 726.5820192098618
04/15/2023, 09:00:15: total loss for 156000 steps : 720.0018965601921
04/15/2023, 09:03:19: total loss for 157000 steps : 712.5533118844032
04/15/2023, 09:06:24: total loss for 158000 steps : 708.9825420379639
04/15/2023, 09:07:10: ---------- start evaluation after epoch 8 ----------
04/15/2023, 09:17:37: validation hit @ 1 is 0.011369610935856993
04/15/2023, 09:17:37: validation hit @ 5 is 0.028062565720294426
04/15/2023, 09:17:37: validation hit @ 10 is 0.04298107255520505
04/15/2023, 09:17:37: validation ncdg @ 5 is 0.020077183794316424
04/15/2023, 09:17:37: validation ncdg @ 10 is 0.02485981730328021
04/15/2023, 09:17:37: validation hit @ 1 is 0.009003680336487907
04/15/2023, 09:17:37: validation hit @ 5 is 0.026879600420609884
04/15/2023, 09:17:37: validation hit @ 10 is 0.04298107255520505
04/15/2023, 09:17:37: validation ncdg @ 5 is 0.018001763184303226
04/15/2023, 09:17:37: validation ncdg @ 10 is 0.02316481580510274
04/15/2023, 09:27:59: test hit @ 1 is 0.007754994742376446
04/15/2023, 09:27:59: test hit @ 5 is 0.021556256572029444
04/15/2023, 09:27:59: test hit @ 10 is 0.03542323869610936
04/15/2023, 09:27:59: test ncdg @ 5 is 0.014645584131761622
04/15/2023, 09:27:59: test ncdg @ 10 is 0.019076323258358608
04/15/2023, 09:27:59: recall increases from 0.041995268138801264 ----> 0.04298107255520505 at epoch 8
04/15/2023, 09:28:03: test hit @ 1 is 0.0065063091482649845
04/15/2023, 09:28:03: test hit @ 5 is 0.02043901156677182
04/15/2023, 09:28:03: test hit @ 10 is 0.035751840168243953
04/15/2023, 09:28:03: test ncdg @ 5 is 0.013312716839399802
04/15/2023, 09:28:03: test ncdg @ 10 is 0.018238555040253977
04/15/2023, 09:28:03: ---------- training epoch 9 ----------
04/15/2023, 09:30:20: total loss for 159000 steps : 700.1957607269287
04/15/2023, 09:33:22: total loss for 160000 steps : 696.5245214104652
04/15/2023, 09:36:25: total loss for 161000 steps : 689.4027473926544
04/15/2023, 09:39:31: total loss for 162000 steps : 683.9339614510536
04/15/2023, 09:42:35: total loss for 163000 steps : 680.9367032051086
04/15/2023, 09:45:37: total loss for 164000 steps : 673.4940614104271
04/15/2023, 09:48:41: total loss for 165000 steps : 667.3077383041382
04/15/2023, 09:51:43: total loss for 166000 steps : 664.5199956297874
04/15/2023, 09:54:46: total loss for 167000 steps : 656.7714837789536
04/15/2023, 09:57:48: total loss for 168000 steps : 652.9159660339355
04/15/2023, 10:00:49: total loss for 169000 steps : 646.3108042478561
04/15/2023, 10:03:52: total loss for 170000 steps : 642.4733815789223
04/15/2023, 10:06:54: total loss for 171000 steps : 634.8547045588493
04/15/2023, 10:09:57: total loss for 172000 steps : 629.7003403306007
04/15/2023, 10:13:00: total loss for 173000 steps : 624.6341816186905
04/15/2023, 10:16:04: total loss for 174000 steps : 616.7755808830261
04/15/2023, 10:19:09: total loss for 175000 steps : 610.7706855237484
04/15/2023, 10:21:43: ---------- start evaluation after epoch 9 ----------
04/15/2023, 10:32:13: validation hit @ 1 is 0.010383806519453207
04/15/2023, 10:32:13: validation hit @ 5 is 0.025236593059936908
04/15/2023, 10:32:13: validation hit @ 10 is 0.03962933753943218
04/15/2023, 10:32:13: validation ncdg @ 5 is 0.01782780266830504
04/15/2023, 10:32:13: validation ncdg @ 10 is 0.022416531705100974
04/15/2023, 10:32:17: validation hit @ 1 is 0.009003680336487907
04/15/2023, 10:32:17: validation hit @ 5 is 0.025236593059936908
04/15/2023, 10:32:17: validation hit @ 10 is 0.04100946372239748
04/15/2023, 10:32:17: validation ncdg @ 5 is 0.0172252643334605
04/15/2023, 10:32:17: validation ncdg @ 10 is 0.022257565400811873
04/15/2023, 10:42:35: test hit @ 1 is 0.008017875920084122
04/15/2023, 10:42:35: test hit @ 5 is 0.021293375394321766
04/15/2023, 10:42:35: test hit @ 10 is 0.034437434279705574
04/15/2023, 10:42:35: test ncdg @ 5 is 0.014623593184916045
04/15/2023, 10:42:35: test ncdg @ 10 is 0.018816714213295675
04/15/2023, 10:42:36: test hit @ 1 is 0.006834910620399579
04/15/2023, 10:42:36: test hit @ 5 is 0.02043901156677182
04/15/2023, 10:42:36: test hit @ 10 is 0.032728706624605676
04/15/2023, 10:42:36: test ncdg @ 5 is 0.01371740420118485
04/15/2023, 10:42:36: test ncdg @ 10 is 0.0176316193110805
04/15/2023, 10:42:36: ---------- training epoch 10 ----------
04/15/2023, 10:43:07: total loss for 176000 steps : 605.8011248707771
04/15/2023, 10:46:09: total loss for 177000 steps : 597.2803995013237
04/15/2023, 10:49:11: total loss for 178000 steps : 593.0767934918404
04/15/2023, 10:52:13: total loss for 179000 steps : 587.4161320030689
04/15/2023, 10:55:14: total loss for 180000 steps : 580.9765411615372
04/15/2023, 10:58:18: total loss for 181000 steps : 579.5297631919384
04/15/2023, 11:01:22: total loss for 182000 steps : 573.1859042942524
04/15/2023, 11:04:26: total loss for 183000 steps : 565.0113439559937
04/15/2023, 11:07:31: total loss for 184000 steps : 559.1863048374653
04/15/2023, 11:10:35: total loss for 185000 steps : 553.2463041245937
04/15/2023, 11:13:37: total loss for 186000 steps : 550.1416473984718
04/15/2023, 11:16:38: total loss for 187000 steps : 542.0043029487133
04/15/2023, 11:19:41: total loss for 188000 steps : 537.4443830549717
04/15/2023, 11:22:44: total loss for 189000 steps : 532.6405936777592
04/15/2023, 11:25:45: total loss for 190000 steps : 526.3711547255516
04/15/2023, 11:28:47: total loss for 191000 steps : 520.4671976864338
04/15/2023, 11:31:53: total loss for 192000 steps : 516.3015249073505
04/15/2023, 11:34:59: total loss for 193000 steps : 509.00255024433136
04/15/2023, 11:36:15: ---------- start evaluation after epoch 10 ----------
04/15/2023, 11:46:45: validation hit @ 1 is 0.011106729758149317
04/15/2023, 11:46:45: validation hit @ 5 is 0.025893796004206097
04/15/2023, 11:46:45: validation hit @ 10 is 0.038183491062039956
04/15/2023, 11:46:45: validation ncdg @ 5 is 0.0184748064625478
04/15/2023, 11:46:45: validation ncdg @ 10 is 0.022413843814245098
04/15/2023, 11:46:47: validation hit @ 1 is 0.009332281808622502
04/15/2023, 11:46:47: validation hit @ 5 is 0.024645110410094637
04/15/2023, 11:46:47: validation hit @ 10 is 0.03811777076761304
04/15/2023, 11:46:47: validation ncdg @ 5 is 0.017211406632705286
04/15/2023, 11:46:47: validation ncdg @ 10 is 0.021520269017737997
04/15/2023, 11:57:07: test hit @ 1 is 0.00814931650893796
04/15/2023, 11:57:07: test hit @ 5 is 0.020176130389064142
04/15/2023, 11:57:07: test hit @ 10 is 0.033123028391167195
04/15/2023, 11:57:07: test ncdg @ 5 is 0.014076324765062792
04/15/2023, 11:57:07: test ncdg @ 10 is 0.018236322798435435
04/15/2023, 11:57:10: test hit @ 1 is 0.007163512092534174
04/15/2023, 11:57:10: test hit @ 5 is 0.020701892744479495
04/15/2023, 11:57:10: test hit @ 10 is 0.0314143007360673
04/15/2023, 11:57:10: test ncdg @ 5 is 0.013979847664848947
04/15/2023, 11:57:10: test ncdg @ 10 is 0.017421246543829795
04/15/2023, 11:57:10: ---------- training epoch 11 ----------
04/15/2023, 11:58:58: total loss for 194000 steps : 503.8854306936264
04/15/2023, 12:02:00: total loss for 195000 steps : 496.64554277062416
04/15/2023, 12:05:05: total loss for 196000 steps : 490.7004044353962
04/15/2023, 12:08:09: total loss for 197000 steps : 488.8420313000679
04/15/2023, 12:11:11: total loss for 198000 steps : 481.8277468085289
04/15/2023, 12:14:13: total loss for 199000 steps : 474.3093489408493
04/15/2023, 12:17:15: total loss for 200000 steps : 470.5039290487766
04/15/2023, 12:20:19: total loss for 201000 steps : 466.23515313863754
04/15/2023, 12:23:24: total loss for 202000 steps : 460.7331677675247
04/15/2023, 12:26:25: total loss for 203000 steps : 456.372033149004
04/15/2023, 12:29:26: total loss for 204000 steps : 453.2642332613468
04/15/2023, 12:32:28: total loss for 205000 steps : 447.26720556616783
04/15/2023, 12:35:30: total loss for 206000 steps : 441.25077217817307
04/15/2023, 12:38:32: total loss for 207000 steps : 433.63592422008514
04/15/2023, 12:41:32: total loss for 208000 steps : 429.98731485009193
04/15/2023, 12:44:35: total loss for 209000 steps : 426.41250267624855
04/15/2023, 12:47:39: total loss for 210000 steps : 420.3996957242489
04/15/2023, 12:50:45: ---------- start evaluation after epoch 11 ----------
04/15/2023, 13:01:16: validation hit @ 1 is 0.009989484752891693
04/15/2023, 13:01:16: validation hit @ 5 is 0.023725026288117772
04/15/2023, 13:01:16: validation hit @ 10 is 0.03509463722397476
04/15/2023, 13:01:16: validation ncdg @ 5 is 0.017027014586012513
04/15/2023, 13:01:16: validation ncdg @ 10 is 0.020712239146399736
04/15/2023, 13:01:20: validation hit @ 1 is 0.009989484752891693
04/15/2023, 13:01:20: validation hit @ 5 is 0.02359358569926393
04/15/2023, 13:01:20: validation hit @ 10 is 0.03706624605678233
04/15/2023, 13:01:20: validation ncdg @ 5 is 0.017041344004482678
04/15/2023, 13:01:20: validation ncdg @ 10 is 0.02139594257131212
04/15/2023, 13:11:45: test hit @ 1 is 0.007097791798107256
04/15/2023, 13:11:45: test hit @ 5 is 0.01958464773922187
04/15/2023, 13:11:45: test hit @ 10 is 0.02937697160883281
04/15/2023, 13:11:45: test ncdg @ 5 is 0.013205494395796111
04/15/2023, 13:11:45: test ncdg @ 10 is 0.016365913048818667
04/15/2023, 13:11:55: test hit @ 1 is 0.007754994742376446
04/15/2023, 13:11:55: test hit @ 5 is 0.02043901156677182
04/15/2023, 13:11:55: test hit @ 10 is 0.030297055730809673
04/15/2023, 13:11:55: test ncdg @ 5 is 0.014058691309494026
04/15/2023, 13:11:55: test ncdg @ 10 is 0.01720644404962966
04/15/2023, 13:11:55: ---------- training epoch 12 ----------
04/15/2023, 13:11:56: total loss for 211000 steps : 418.8306802213192
04/15/2023, 13:14:59: total loss for 212000 steps : 408.9278249144554
04/15/2023, 13:18:01: total loss for 213000 steps : 406.8012973666191
04/15/2023, 13:21:04: total loss for 214000 steps : 399.36749958992004
04/15/2023, 13:24:07: total loss for 215000 steps : 397.28080359101295
04/15/2023, 13:27:11: total loss for 216000 steps : 390.69044011831284
04/15/2023, 13:30:13: total loss for 217000 steps : 388.8883095383644
04/15/2023, 13:33:16: total loss for 218000 steps : 382.86767131090164
04/15/2023, 13:36:18: total loss for 219000 steps : 378.7148460149765
04/15/2023, 13:39:21: total loss for 220000 steps : 373.7258553802967
04/15/2023, 13:42:24: total loss for 221000 steps : 371.2585546076298
04/15/2023, 13:45:25: total loss for 222000 steps : 363.51580387353897
04/15/2023, 13:48:26: total loss for 223000 steps : 360.4572571218014
04/15/2023, 13:51:27: total loss for 224000 steps : 356.7388528883457
04/15/2023, 13:54:29: total loss for 225000 steps : 351.0152221620083
04/15/2023, 13:57:33: total loss for 226000 steps : 343.6926352083683
04/15/2023, 14:00:35: total loss for 227000 steps : 341.7047979235649
04/15/2023, 14:03:37: total loss for 228000 steps : 339.531122893095
04/15/2023, 14:05:23: ---------- start evaluation after epoch 12 ----------
04/15/2023, 14:15:50: validation hit @ 1 is 0.00874079915878023
04/15/2023, 14:15:50: validation hit @ 5 is 0.023396424815983176
04/15/2023, 14:15:50: validation hit @ 10 is 0.03470031545741325
04/15/2023, 14:15:50: validation ncdg @ 5 is 0.016180982381549677
04/15/2023, 14:15:50: validation ncdg @ 10 is 0.01980531577191785
04/15/2023, 14:15:54: validation hit @ 1 is 0.01090956887486856
04/15/2023, 14:15:54: validation hit @ 5 is 0.022673501577287068
04/15/2023, 14:15:54: validation hit @ 10 is 0.033123028391167195
04/15/2023, 14:15:54: validation ncdg @ 5 is 0.016735752803696144
04/15/2023, 14:15:54: validation ncdg @ 10 is 0.020060940702976367
